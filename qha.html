
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Quasi harmonic approximation &#8212; Phonopy v.2.28.0</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=a91ddd6e"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'qha';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Random displacements" href="random-displacements.html" />
    <link rel="prev" title="Calculation of mode Grüneisen parameters" href="gruneisen.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Phonopy v.2.28.0</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="symmetry.html">Crystal symmetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">Work flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="input-files.html">Input files</a></li>
<li class="toctree-l1"><a class="reference internal" href="output-files.html">Output files</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="setting-tags.html">Setting tags</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="animation.html">How to watch animation</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="command-options.html">Command options</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamic-structure-factor.html">Dynamic structure factor</a></li>
<li class="toctree-l1"><a class="reference internal" href="gruneisen.html">Mode Grüneisen parameters</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Quasi harmonic approximation</a></li>
<li class="toctree-l1"><a class="reference internal" href="random-displacements.html">Random displacements</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="interfaces.html">Interfaces to calculators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="vasp.html">VASP &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="wien2k.html">Wien2k &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="qe.html">Quantum ESPRESSO (QE) &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="abinit.html">Abinit &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="siesta.html">Siesta &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="elk.html">Elk &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="crystal.html">CRYSTAL &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="dftb%2B.html">DFTB+ &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="turbomole.html">TURBOMOLE &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="cp2k.html">CP2K &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="aims.html">FHI-aims &amp; phonopy calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="castep.html">CASTEP &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Fleur.html">Fleur &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="abacus.html">ABACUS &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="lammps.html">LAMMPS &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="vasp-dfpt.html">VASP-DFPT &amp; phonopy calculation</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="auxiliary-tools.html">Auxiliary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="external-tools.html">External tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="phonopy-module.html">Phonopy API for Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="phonopy-yaml.html">phonopy-yaml format</a></li>
<li class="toctree-l1"><a class="reference internal" href="phonopy-load.html">phonopy-load command</a></li>
<li class="toctree-l1"><a class="reference internal" href="formulation.html">Formulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">How to cite phonopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change Log</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/qha.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Quasi harmonic approximation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usage-of-phonopy-qha">Usage of <code class="docutils literal notranslate"><span class="pre">phonopy-qha</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#options">Options</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#h"><code class="docutils literal notranslate"><span class="pre">-h</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tmax"><code class="docutils literal notranslate"><span class="pre">--tmax</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pressure"><code class="docutils literal notranslate"><span class="pre">--pressure</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#b"><code class="docutils literal notranslate"><span class="pre">-b</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#eos"><code class="docutils literal notranslate"><span class="pre">--eos</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#p"><code class="docutils literal notranslate"><span class="pre">-p</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#s"><code class="docutils literal notranslate"><span class="pre">-s</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sparse"><code class="docutils literal notranslate"><span class="pre">--sparse</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#efe"><code class="docutils literal notranslate"><span class="pre">--efe</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#output-files">Output files</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermal-properties-in-t-p-space-calculated-under-qha">Thermal properties in (<em>T</em>, <em>p</em>) space calculated under QHA</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="quasi-harmonic-approximation">
<span id="phonopy-qha"></span><h1>Quasi harmonic approximation<a class="headerlink" href="#quasi-harmonic-approximation" title="Link to this heading">#</a></h1>
<section id="usage-of-phonopy-qha">
<h2>Usage of <code class="docutils literal notranslate"><span class="pre">phonopy-qha</span></code><a class="headerlink" href="#usage-of-phonopy-qha" title="Link to this heading">#</a></h2>
<p>Using phonopy results of thermal properties, thermal expansion and heat capacity
at constant pressure can be calculated under the quasi-harmonic approximation.
<code class="docutils literal notranslate"><span class="pre">phonopy-qha</span></code> is the script to run fitting and calculation to perform it. Mind
that at leave 5 volume points are needed to run <code class="docutils literal notranslate"><span class="pre">phonopy-qha</span></code> for fitting.</p>
<p>An example of the usage for <code class="docutils literal notranslate"><span class="pre">example/Si-QHA</span></code> is as follows.</p>
<p>To watch selected plots:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">phonopy</span><span class="o">-</span><span class="n">qha</span> <span class="o">-</span><span class="n">p</span> <span class="n">e</span><span class="o">-</span><span class="n">v</span><span class="o">.</span><span class="n">dat</span> <span class="n">thermal_properties</span><span class="o">.</span><span class="n">yaml</span><span class="o">-</span><span class="p">{</span><span class="o">-</span><span class="p">{</span><span class="mf">5..1</span><span class="p">},{</span><span class="mf">0..5</span><span class="p">}}</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="_images/Si-QHA.png" src="_images/Si-QHA.png" />
</figure>
<p>Without plots:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">phonopy</span><span class="o">-</span><span class="n">qha</span> <span class="n">e</span><span class="o">-</span><span class="n">v</span><span class="o">.</span><span class="n">dat</span> <span class="n">thermal_properties</span><span class="o">.</span><span class="n">yaml</span><span class="o">-</span><span class="p">{</span><span class="o">-</span><span class="p">{</span><span class="mf">5..1</span><span class="p">},{</span><span class="mf">0..5</span><span class="p">}}</span>
</pre></div>
</div>
<p>The first argument is the filename of volume-energy data (in the above example,
<code class="docutils literal notranslate"><span class="pre">e-v.dat</span></code>). The volumes and energies are given in <span class="math notranslate nohighlight">\(\text{Angstrom}^3\)</span> and
eV, respectively. Theses energies are only dependent on volume but not on
temperature unless using <code class="docutils literal notranslate"><span class="pre">--efe</span></code> option. Therefore in the simplest case, these
are taken as the electronic total energies at 0K. An example of the
volume-energy file is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#   cell volume   energy of cell other than phonon</span>
     <span class="mf">140.030000</span>           <span class="o">-</span><span class="mf">42.132246</span>
     <span class="mf">144.500000</span>           <span class="o">-</span><span class="mf">42.600974</span>
     <span class="mf">149.060000</span>           <span class="o">-</span><span class="mf">42.949142</span>
     <span class="mf">153.720000</span>           <span class="o">-</span><span class="mf">43.188162</span>
     <span class="mf">158.470000</span>           <span class="o">-</span><span class="mf">43.326751</span>
     <span class="mf">163.320000</span>           <span class="o">-</span><span class="mf">43.375124</span>
     <span class="mf">168.270000</span>           <span class="o">-</span><span class="mf">43.339884</span>
     <span class="mf">173.320000</span>           <span class="o">-</span><span class="mf">43.230619</span>
     <span class="mf">178.470000</span>           <span class="o">-</span><span class="mf">43.054343</span>
     <span class="mf">183.720000</span>           <span class="o">-</span><span class="mf">42.817825</span>
     <span class="mf">189.070000</span>           <span class="o">-</span><span class="mf">42.527932</span>
</pre></div>
</div>
<p>Lines starting with <code class="docutils literal notranslate"><span class="pre">#</span></code> are ignored.</p>
<p>The following arguments of <code class="docutils literal notranslate"><span class="pre">phonopy-qha</span></code> are the filenames of
<code class="docutils literal notranslate"><span class="pre">thermal_properties.yaml</span></code>’s calculated at the volumes given in the volume-energy
file. These filenames have to be ordered in the same order as the volumes
written in the volume-energy file. Since the volume v.s. free energy fitting is
done at each temperature given in <code class="docutils literal notranslate"><span class="pre">thermal_properties.yaml</span></code>, all
<code class="docutils literal notranslate"><span class="pre">thermal_properties.yaml</span></code>’s have to be calculated in the same temperature ranges
and with the same temperature step. <code class="docutils literal notranslate"><span class="pre">phonopy-qha</span></code> can calculate thermal
properties at constant pressure up to the temperature point that is one point
less than that in <code class="docutils literal notranslate"><span class="pre">thermal_properties.yaml</span></code> because of the numerical
differentiation with respect to temperature points. Therefore
<code class="docutils literal notranslate"><span class="pre">thermal_properties.yaml</span></code> has to be calculated up to higher temperatures than
that expected by <code class="docutils literal notranslate"><span class="pre">phonopy-qha</span></code>.</p>
<p>Another example for Aluminum is found in the <code class="docutils literal notranslate"><span class="pre">example/Al-QHA</span></code> directory.</p>
<p>If the condition under pressure is expected, <span class="math notranslate nohighlight">\(PV\)</span> terms may be included in
the energies, or equivalent effect is applied using <code class="docutils literal notranslate"><span class="pre">--pressure</span></code> option.</p>
<p>Experimentally, temperature dependent energies are supported by <code class="docutils literal notranslate"><span class="pre">--efe</span></code> option.
The usage is written at
<a class="github reference external" href="https://github.com/phonopy/phonopy/blob/develop/example/Cu-QHA/README">phonopy/phonopy</a>.</p>
<section id="options">
<span id="phonopy-qha-options"></span><h3>Options<a class="headerlink" href="#options" title="Link to this heading">#</a></h3>
<section id="h">
<h4><code class="docutils literal notranslate"><span class="pre">-h</span></code><a class="headerlink" href="#h" title="Link to this heading">#</a></h4>
<p>Show help. The available options are shown. Without any option, the results are
saved into text files in simple data format.</p>
</section>
<section id="tmax">
<h4><code class="docutils literal notranslate"><span class="pre">--tmax</span></code><a class="headerlink" href="#tmax" title="Link to this heading">#</a></h4>
<p>The maximum temperature calculated is specified. This temperature has to be
lower than the maximum temperature calculated in <code class="docutils literal notranslate"><span class="pre">thermal_properties.yaml</span></code> to
let at least one temperature points fewer. The default value is <code class="docutils literal notranslate"><span class="pre">--tmax=1000</span></code>.</p>
</section>
<section id="pressure">
<h4><code class="docutils literal notranslate"><span class="pre">--pressure</span></code><a class="headerlink" href="#pressure" title="Link to this heading">#</a></h4>
<p>Pressure is specified in GPa. This corresponds to the <span class="math notranslate nohighlight">\(pV\)</span> term described
in the following section <a class="reference internal" href="#theory-of-qha"><span class="std std-ref">Thermal properties in (T, p) space calculated under QHA</span></a>. Note that bulk modulus obtained
with this option than 0 GPa is incorrect.</p>
</section>
<section id="b">
<h4><code class="docutils literal notranslate"><span class="pre">-b</span></code><a class="headerlink" href="#b" title="Link to this heading">#</a></h4>
<p>Fitting volume-energy data to an EOS, and show bulk modulus (without considering
phonons). This is made by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">phonopy</span><span class="o">-</span><span class="n">qha</span> <span class="o">-</span><span class="n">b</span> <span class="n">e</span><span class="o">-</span><span class="n">v</span><span class="o">.</span><span class="n">dat</span>
</pre></div>
</div>
</section>
<section id="eos">
<h4><code class="docutils literal notranslate"><span class="pre">--eos</span></code><a class="headerlink" href="#eos" title="Link to this heading">#</a></h4>
<p>EOS is chosen among <code class="docutils literal notranslate"><span class="pre">vinet</span></code>, <code class="docutils literal notranslate"><span class="pre">birch_murnaghan</span></code>, and <code class="docutils literal notranslate"><span class="pre">murnaghan</span></code>. The default EOS
is <code class="docutils literal notranslate"><span class="pre">vinet</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">phonopy</span><span class="o">-</span><span class="n">qha</span> <span class="o">--</span><span class="n">eos</span><span class="o">=</span><span class="s1">&#39;birch_murnaghan&#39;</span> <span class="o">-</span><span class="n">b</span> <span class="n">e</span><span class="o">-</span><span class="n">v</span><span class="o">.</span><span class="n">dat</span>
</pre></div>
</div>
</section>
<section id="p">
<h4><code class="docutils literal notranslate"><span class="pre">-p</span></code><a class="headerlink" href="#p" title="Link to this heading">#</a></h4>
<p>The fitting results, volume-temperature relation, and thermal expansion
coefficient are plotted on the display.</p>
</section>
<section id="s">
<h4><code class="docutils literal notranslate"><span class="pre">-s</span></code><a class="headerlink" href="#s" title="Link to this heading">#</a></h4>
<p>The calculated values are written into files.</p>
</section>
<section id="sparse">
<h4><code class="docutils literal notranslate"><span class="pre">--sparse</span></code><a class="headerlink" href="#sparse" title="Link to this heading">#</a></h4>
<p>This is used with <code class="docutils literal notranslate"><span class="pre">-s</span></code> or <code class="docutils literal notranslate"><span class="pre">-p</span></code> to thin out the number of plots of the fitting
results at temperatures. For example with <code class="docutils literal notranslate"><span class="pre">--sparse=10</span></code>, 1 in 10 temperature
curves is only plotted.</p>
</section>
<section id="efe">
<span id="phonopy-qha-efe-option"></span><h4><code class="docutils literal notranslate"><span class="pre">--efe</span></code><a class="headerlink" href="#efe" title="Link to this heading">#</a></h4>
<p><strong>Experimental</strong></p>
<p>Temperature dependent energies other than phonon free energy are included with
this option. This is used such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">phonopy</span><span class="o">-</span><span class="n">qha</span> <span class="o">-</span><span class="n">p</span> <span class="o">--</span><span class="n">tmax</span><span class="o">=</span><span class="mi">1300</span> <span class="o">--</span><span class="n">efe</span> <span class="n">fe</span><span class="o">-</span><span class="n">v</span><span class="o">.</span><span class="n">dat</span> <span class="n">e</span><span class="o">-</span><span class="n">v</span><span class="o">.</span><span class="n">dat</span> <span class="n">thermal_properties</span><span class="o">.</span><span class="n">yaml</span><span class="o">-</span><span class="p">{</span><span class="mf">00..10</span><span class="p">}</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="_images/Cu-QHA.png" src="_images/Cu-QHA.png" />
</figure>
<p>The temperature dependent energies are stored in <code class="docutils literal notranslate"><span class="pre">fe-v.dat</span></code>. The file format is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># volume:       43.08047896     43.97798894     44.87549882     45.77300889     46.67051887     47.56802885     48.46553883     49.36304881     50.26055878     51.15806876     52.05557874</span>
<span class="c1">#    T(K)     Free energies</span>
    <span class="mf">0.0000</span>     <span class="o">-</span><span class="mf">17.27885993</span>    <span class="o">-</span><span class="mf">17.32227490</span>    <span class="o">-</span><span class="mf">17.34336569</span>    <span class="o">-</span><span class="mf">17.34479760</span>    <span class="o">-</span><span class="mf">17.32843604</span>    <span class="o">-</span><span class="mf">17.29673896</span>    <span class="o">-</span><span class="mf">17.25081954</span>    <span class="o">-</span><span class="mf">17.19263337</span>    <span class="o">-</span><span class="mf">17.12356816</span>    <span class="o">-</span><span class="mf">17.04467997</span>    <span class="o">-</span><span class="mf">16.95752155</span>
   <span class="mf">10.0000</span>     <span class="o">-</span><span class="mf">17.27886659</span>    <span class="o">-</span><span class="mf">17.32228126</span>    <span class="o">-</span><span class="mf">17.34337279</span>    <span class="o">-</span><span class="mf">17.34481060</span>    <span class="o">-</span><span class="mf">17.32844885</span>    <span class="o">-</span><span class="mf">17.29675204</span>    <span class="o">-</span><span class="mf">17.25083261</span>    <span class="o">-</span><span class="mf">17.19264615</span>    <span class="o">-</span><span class="mf">17.12358094</span>    <span class="o">-</span><span class="mf">17.04469309</span>    <span class="o">-</span><span class="mf">16.95753464</span>
   <span class="mf">20.0000</span>     <span class="o">-</span><span class="mf">17.27887453</span>    <span class="o">-</span><span class="mf">17.32228804</span>    <span class="o">-</span><span class="mf">17.34338499</span>    <span class="o">-</span><span class="mf">17.34482383</span>    <span class="o">-</span><span class="mf">17.32846353</span>    <span class="o">-</span><span class="mf">17.29676491</span>    <span class="o">-</span><span class="mf">17.25084547</span>    <span class="o">-</span><span class="mf">17.19265900</span>    <span class="o">-</span><span class="mf">17.12359399</span>    <span class="o">-</span><span class="mf">17.04470709</span>    <span class="o">-</span><span class="mf">16.95754774</span>
<span class="o">...</span>
</pre></div>
</div>
<p>The first column gives temperatures in K and the following columns give
electronic free energies in eV at temperatures and at unit (primitive) cell
volumes. The lines starting with <code class="docutils literal notranslate"><span class="pre">#</span></code> are ignored. This file doesn’t contain the
information about cell volumes. Instead, the volumes are obtained from <code class="docutils literal notranslate"><span class="pre">e-v.dat</span></code>
file. The energies in <code class="docutils literal notranslate"><span class="pre">e-v.dat</span></code> are not used when <code class="docutils literal notranslate"><span class="pre">--efe</span></code> option is used. The
temperature points are expected to be the same as those in
<code class="docutils literal notranslate"><span class="pre">thermal_properties.yaml</span></code> at least up to the maximum temperature specified for
<code class="docutils literal notranslate"><span class="pre">phonopy-qha</span></code>.</p>
<p>An example is given in <code class="docutils literal notranslate"><span class="pre">example/Cu-QHA</span></code>. The <code class="docutils literal notranslate"><span class="pre">fe-v.dat</span></code> contains electronic free
energy calculated following, e.g., Eqs. (11) and (12) in the paper by Wolverton
and Zunger, Phys. Rev. B, <strong>52</strong>, 8813 (1994) (of course this paper is not the
first one that showed these equations):</p>
<div class="math notranslate nohighlight">
\[S_\text{el}(V) = -gk_{\mathrm{B}}\Sigma_i \{ f_i(V) \ln f_i(V) + [1-f_i(V)]\ln
[1-f_i(V)] \}\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[f_i(V) = \left\{ 1 + \exp\left[\frac{\epsilon_i(V) - \mu(V)}{T}\right]
\right\}^{-1}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[E_\text{el}(V) = g\sum_i f_i(V) \epsilon_i(V),\]</div>
<p>where <span class="math notranslate nohighlight">\(g\)</span> is 1 or 2 for collinear spin polarized and non-spin polarized
systems, respectively. For VASP, a script to create <code class="docutils literal notranslate"><span class="pre">fe-v.dat</span></code> and <code class="docutils literal notranslate"><span class="pre">e-v.dat</span></code> by
these equations is prepared as <code class="docutils literal notranslate"><span class="pre">phonopy-vasp-efe</span></code>, which is used as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">phonopy</span><span class="o">-</span><span class="n">vasp</span><span class="o">-</span><span class="n">efe</span> <span class="o">--</span><span class="n">tmax</span><span class="o">=</span><span class="mi">1500</span> <span class="n">vasprun</span><span class="o">.</span><span class="n">xml</span><span class="o">-</span><span class="p">{</span><span class="mf">00..10</span><span class="p">}</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">vasprun.xml-{00..10}</span></code> have to be computed for the same unit cells as
those used for <code class="docutils literal notranslate"><span class="pre">thermal_properties.yaml</span></code>. When <code class="docutils literal notranslate"><span class="pre">phonopy</span></code> was run with
<code class="docutils literal notranslate"><span class="pre">PRIMITIVE_AXES</span></code> or <code class="docutils literal notranslate"><span class="pre">--pa</span></code> option, the unit cells for computing electronic
eigenvalues have to be carefully chosen to agree with those after applying
<code class="docutils literal notranslate"><span class="pre">PRIMITIVE_AXES</span></code>, or energies are scaled a posteriori.</p>
</section>
</section>
<section id="output-files">
<span id="phonopy-qha-output-files"></span><h3>Output files<a class="headerlink" href="#output-files" title="Link to this heading">#</a></h3>
<p>The physical units of V and T are <span class="math notranslate nohighlight">\(\text{Angstrom}^3\)</span> and K, respectively.
The unit of eV for Helmholtz and Gibbs energies, J/K/mol for <span class="math notranslate nohighlight">\(C_V\)</span> and
entropy, GPa for for bulk modulus and pressure are used.</p>
<ul class="simple">
<li><p>Bulk modulus <span class="math notranslate nohighlight">\(B_T\)</span> (GPa) vs <span class="math notranslate nohighlight">\(T\)</span> (<code class="docutils literal notranslate"><span class="pre">bulk_modulus-temperature.*</span></code>)</p></li>
<li><p>Gibbs free energy <span class="math notranslate nohighlight">\(G\)</span> (eV) vs <span class="math notranslate nohighlight">\(T\)</span> (<code class="docutils literal notranslate"><span class="pre">gibbs-temperature.*</span></code>)</p></li>
<li><p>Heat capacity at constant pressure <span class="math notranslate nohighlight">\(C_p\)</span> (J/K/mol) vs <span class="math notranslate nohighlight">\(T\)</span> computed
by <span class="math notranslate nohighlight">\(-T\frac{\partial^2 G}{\partial T^2}\)</span> from three <span class="math notranslate nohighlight">\(G(T)\)</span> points
(<code class="docutils literal notranslate"><span class="pre">Cp-temperature.*</span></code>)</p></li>
<li><p>Heat capacity at constant pressure <span class="math notranslate nohighlight">\(C_p\)</span> (J/K/mol) vs <span class="math notranslate nohighlight">\(T\)</span> computed
by polynomial fittings of <span class="math notranslate nohighlight">\(C_V(V)\)</span> (<code class="docutils literal notranslate"><span class="pre">Cv-volume.dat</span></code>) and <span class="math notranslate nohighlight">\(S(V)\)</span>
(<code class="docutils literal notranslate"><span class="pre">entropy-volume.dat</span></code>) for <span class="math notranslate nohighlight">\(\partial S/\partial V\)</span>
(<code class="docutils literal notranslate"><span class="pre">dsdv-temperature.dat</span></code>) and numerical differentiation of
<span class="math notranslate nohighlight">\(\partial V/\partial T\)</span>, e.g., see Eq.(5) of PRB <strong>81</strong>, 174301 by Togo
<em>et al.</em> (<code class="docutils literal notranslate"><span class="pre">Cp-temperature_polyfit.*</span></code>). This may give smoother <span class="math notranslate nohighlight">\(C_p\)</span> than
that from <span class="math notranslate nohighlight">\(-T\frac{\partial^2 G}{\partial T^2}\)</span>.</p></li>
<li><p>Volumetric thermal expansion coefficient <span class="math notranslate nohighlight">\(\beta\)</span> vs <span class="math notranslate nohighlight">\(T\)</span> computed
by numerical differentiation (<code class="docutils literal notranslate"><span class="pre">thermal_expansion.*</span></code>)</p></li>
<li><p>Volume vs <span class="math notranslate nohighlight">\(T\)</span> (<code class="docutils literal notranslate"><span class="pre">volume-temperature.*</span></code>)</p></li>
<li><p>Thermodynamics Grüneisen parameter <span class="math notranslate nohighlight">\(\gamma = V\beta B_T/C_V\)</span> (no unit)
vs <span class="math notranslate nohighlight">\(T\)</span> (<code class="docutils literal notranslate"><span class="pre">gruneisen-temperature.dat</span></code>)</p></li>
<li><p>Helmholtz free energy (eV) vs volume (<code class="docutils literal notranslate"><span class="pre">helmholtz-volume.*</span></code>). When <code class="docutils literal notranslate"><span class="pre">--pressure</span></code>
option is specified, energy offset of <span class="math notranslate nohighlight">\(pV\)</span> is added. See also the
following section (<a class="reference internal" href="#theory-of-qha"><span class="std std-ref">Thermal properties in (T, p) space calculated under QHA</span></a>).</p></li>
</ul>
</section>
</section>
<section id="thermal-properties-in-t-p-space-calculated-under-qha">
<span id="theory-of-qha"></span><h2>Thermal properties in (<em>T</em>, <em>p</em>) space calculated under QHA<a class="headerlink" href="#thermal-properties-in-t-p-space-calculated-under-qha" title="Link to this heading">#</a></h2>
<p>Here the word ‘quasi-harmonic approximation’ is used for an approximation that
introduces volume dependence of phonon frequencies as a part of anharmonic
effect.</p>
<p>A part of temperature effect can be included into total energy of electronic
structure through phonon (Helmholtz) free energy at constant volume. But what we
want to know is thermal properties at constant pressure. We need some
transformation from function of <em>V</em> to function of <em>p</em>. Gibbs free energy is
defined at a constant pressure by the transformation:</p>
<div class="math notranslate nohighlight">
\[G(T, p) = \min_V \left[ U(V) + F_\mathrm{phonon}(T;\,V) + pV \right],\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\min_V[ \text{function of } V ]\]</div>
<p>means to find unique minimum value in the brackets by changing volume. Since
volume dependencies of energies in electronic and phonon structures are
different, volume giving the minimum value of the energy function in the square
brackets shifts from the value calculated only from electronic structure even at
0 K. By increasing temperature, the volume dependence of phonon free energy
changes, then the equilibrium volume at temperatures changes. This is considered
as thermal expansion under this approximation.</p>
<p><code class="docutils literal notranslate"><span class="pre">phonopy-qha</span></code> collects the values at volumes and transforms into the thermal
properties at constant pressure.</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="gruneisen.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Calculation of mode Grüneisen parameters</p>
      </div>
    </a>
    <a class="right-next"
       href="random-displacements.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Random displacements</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usage-of-phonopy-qha">Usage of <code class="docutils literal notranslate"><span class="pre">phonopy-qha</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#options">Options</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#h"><code class="docutils literal notranslate"><span class="pre">-h</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tmax"><code class="docutils literal notranslate"><span class="pre">--tmax</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pressure"><code class="docutils literal notranslate"><span class="pre">--pressure</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#b"><code class="docutils literal notranslate"><span class="pre">-b</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#eos"><code class="docutils literal notranslate"><span class="pre">--eos</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#p"><code class="docutils literal notranslate"><span class="pre">-p</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#s"><code class="docutils literal notranslate"><span class="pre">-s</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sparse"><code class="docutils literal notranslate"><span class="pre">--sparse</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#efe"><code class="docutils literal notranslate"><span class="pre">--efe</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#output-files">Output files</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermal-properties-in-t-p-space-calculated-under-qha">Thermal properties in (<em>T</em>, <em>p</em>) space calculated under QHA</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Author name not set
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2009, Atsushi Togo.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>