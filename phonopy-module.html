
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Phonopy API for Python &#8212; Phonopy v.2.43.1</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=068884b4"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'phonopy-module';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="phonopy-yaml format" href="phonopy-yaml.html" />
    <link rel="prev" title="External tools" href="external-tools.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Phonopy v.2.43.1</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="symmetry.html">Crystal symmetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">Work flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="input-files.html">Input files</a></li>
<li class="toctree-l1"><a class="reference internal" href="output-files.html">Output files</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="setting-tags.html">Setting tags</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="animation.html">How to watch animation</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="command-options.html">Command options</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamic-structure-factor.html">Dynamic structure factor</a></li>
<li class="toctree-l1"><a class="reference internal" href="gruneisen.html">Mode Gr√ºneisen parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="qha.html">Quasi harmonic approximation</a></li>
<li class="toctree-l1"><a class="reference internal" href="random-displacements.html">Random displacements</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="interfaces.html">Interfaces to calculators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="vasp.html">VASP &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="wien2k.html">Wien2k &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="qe.html">Quantum ESPRESSO (QE) &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="abinit.html">Abinit &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="siesta.html">Siesta &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="elk.html">Elk &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="crystal.html">CRYSTAL &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="dftb%2B.html">DFTB+ &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="turbomole.html">TURBOMOLE &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="cp2k.html">CP2K &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="aims.html">FHI-aims &amp; phonopy calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="castep.html">CASTEP &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Fleur.html">Fleur &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="abacus.html">ABACUS &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="lammps.html">LAMMPS &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="qlm.html">Questaal &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="vasp-dfpt.html">VASP-DFPT &amp; phonopy calculation</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="auxiliary-tools.html">Auxiliary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="external-tools.html">External tools</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Phonopy API for Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="phonopy-yaml.html">phonopy-yaml format</a></li>
<li class="toctree-l1"><a class="reference internal" href="phonopy-load.html">phonopy-load command</a></li>
<li class="toctree-l1"><a class="reference internal" href="mlp-sscha.html">Temperature dependent force constants calculation using pypolymlp and symfc</a></li>
<li class="toctree-l1"><a class="reference internal" href="formulation.html">Formulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">How to cite phonopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change Log</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/phonopy-module.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Phonopy API for Python</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#three-unit-cells">Three unit cells</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-modules">Import modules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#work-flow">Work flow</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-process">Pre-process</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculators">Calculators</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-processing-example">Pre-processing Example</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#post-process">Post process</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#phonon-calculation">Phonon calculation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#save-parameters-phonopy-save">Save parameters (<code class="docutils literal notranslate"><span class="pre">phonopy.save</span></code>)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#band-structure">Band structure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mesh-sampling">Mesh sampling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dos-and-pdos">DOS and PDOS</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thermal-properties">Thermal properties</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#non-analytical-term-correction">Non-analytical term correction</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-structure">Data structure</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eigenvectors">Eigenvectors</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Band structure</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Mesh sampling</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#phonopyatoms-class"><code class="docutils literal notranslate"><span class="pre">PhonopyAtoms</span></code> class</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initialization">Initialization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variables">Variables</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cell"><code class="docutils literal notranslate"><span class="pre">cell</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#scaled-positions"><code class="docutils literal notranslate"><span class="pre">scaled_positions</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#positions"><code class="docutils literal notranslate"><span class="pre">positions</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#symbols"><code class="docutils literal notranslate"><span class="pre">symbols</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#numbers"><code class="docutils literal notranslate"><span class="pre">numbers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#masses"><code class="docutils literal notranslate"><span class="pre">masses</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#attributes">Attributes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#methods">Methods</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definitions-of-variables">Definitions of variables</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#supercell-matrix">Supercell matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#primitive-matrix">Primitive matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#symmetry-search-tolerance">Symmetry search tolerance</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-phonopy-settings-phonopy-load">Load phonopy settings <code class="docutils literal notranslate"><span class="pre">phonopy.load</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-and-write-crystal-structures">Read and write crystal structures</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-parameters-for-non-analytical-term-correction">Getting parameters for non-analytical term correction</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="phonopy-api-for-python">
<span id="phonopy-module"></span><h1>Phonopy API for Python<a class="headerlink" href="#phonopy-api-for-python" title="Link to this heading">#</a></h1>
<section id="three-unit-cells">
<h2>Three unit cells<a class="headerlink" href="#three-unit-cells" title="Link to this heading">#</a></h2>
<p>In the <code class="docutils literal notranslate"><span class="pre">Phonopy</span></code> class, mainly three different unit cells are used, <code class="docutils literal notranslate"><span class="pre">unitcell</span></code>,
<code class="docutils literal notranslate"><span class="pre">supercell</span></code>, and <code class="docutils literal notranslate"><span class="pre">primitive</span></code>, which can be accessed with these attributes in the
instance. <code class="docutils literal notranslate"><span class="pre">unitcell</span></code> is the initial input crystal structure. From <code class="docutils literal notranslate"><span class="pre">unitcell</span></code>,
<code class="docutils literal notranslate"><span class="pre">supercell</span></code> is created by <code class="docutils literal notranslate"><span class="pre">supercell_matrix</span></code> (<a class="reference internal" href="#variable-supercell-matrix"><span class="std std-ref">Supercell matrix</span></a>).
Then <code class="docutils literal notranslate"><span class="pre">primitive</span></code> is created from <code class="docutils literal notranslate"><span class="pre">supercell</span></code> with <code class="docutils literal notranslate"><span class="pre">supercell_matrix</span></code> and
<code class="docutils literal notranslate"><span class="pre">primitive_matrix</span></code> (<a class="reference internal" href="#variable-primitive-matrix"><span class="std std-ref">Primitive matrix</span></a>).</p>
<p>Having the <code class="docutils literal notranslate"><span class="pre">supercell_matrix</span></code> (<span class="math notranslate nohighlight">\(\mathrm{M}_\mathrm{s}\)</span>) and the
<code class="docutils literal notranslate"><span class="pre">primitive</span> <span class="pre">matrix</span></code> (<span class="math notranslate nohighlight">\(\mathrm{M}_\mathrm{p}\)</span>), for example,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathrm{M}_\mathrm{s} = \begin{pmatrix}
2 &amp; 0 &amp; 0 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 0 &amp; 2
\end{pmatrix} \;\text{and}\;\;
\mathrm{M}_\mathrm{p} = \begin{pmatrix}
0 &amp; 1/2 &amp; 1/2 \\ 1/2 &amp; 0 &amp; 1/2 \\ 1/2 &amp; 1/2 &amp; 0
\end{pmatrix},\end{split}\]</div>
<p>respectively, the basis vectors of <code class="docutils literal notranslate"><span class="pre">supercell</span></code> are built from those of
<code class="docutils literal notranslate"><span class="pre">unitcell</span></code> by</p>
<div class="math notranslate nohighlight">
\[( \mathbf{a}_\mathrm{s} \; \mathbf{b}_\mathrm{s} \; \mathbf{c}_\mathrm{s} ) = (
\mathbf{a}_\mathrm{u} \; \mathbf{b}_\mathrm{u} \; \mathbf{c}_\mathrm{u} )
\mathrm{M}_\mathrm{s}\]</div>
<p>and the basis vectors of <code class="docutils literal notranslate"><span class="pre">primitive</span></code> are built from those of <code class="docutils literal notranslate"><span class="pre">supercell</span></code> by</p>
<div class="math notranslate nohighlight">
\[( \mathbf{a}_\mathrm{p} \; \mathbf{b}_\mathrm{p} \; \mathbf{c}_\mathrm{p} ) = (
\mathbf{a}_\mathrm{s} \; \mathbf{b}_\mathrm{s} \; \mathbf{c}_\mathrm{s} )
\mathrm{M}_\mathrm{s}^{-1} \mathrm{M}_\mathrm{p}.\]</div>
<p>Once <code class="docutils literal notranslate"><span class="pre">supercell</span></code> and <code class="docutils literal notranslate"><span class="pre">primitive</span></code> are made, <code class="docutils literal notranslate"><span class="pre">unitcell</span></code> will not be used
basically.</p>
</section>
<section id="import-modules">
<h2>Import modules<a class="headerlink" href="#import-modules" title="Link to this heading">#</a></h2>
<p>After setting the phonopy python path, the phonopy module is imported by:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">phonopy</span><span class="w"> </span><span class="kn">import</span> <span class="n">Phonopy</span>
</pre></div>
</div>
<p>Crystal structure is defined by the <code class="docutils literal notranslate"><span class="pre">PhonopyAtoms</span></code> class. The <code class="docutils literal notranslate"><span class="pre">PhonopyAtoms</span></code>
module is imported by:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">phonopy.structure.atoms</span><span class="w"> </span><span class="kn">import</span> <span class="n">PhonopyAtoms</span>
</pre></div>
</div>
<p>The instance of <code class="docutils literal notranslate"><span class="pre">PhonopyAtoms</span></code> can be made by reading a crystal structure in a
variety of calculator formats found at <a class="reference internal" href="interfaces.html#calculator-interfaces"><span class="std std-ref">Interfaces to calculators</span></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">phonopy.interface.calculator</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_crystal_structure</span>
<span class="n">unitcell</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">read_crystal_structure</span><span class="p">(</span><span class="s2">&quot;POSCAR-unitcell&quot;</span><span class="p">,</span> <span class="n">interface_mode</span><span class="o">=</span><span class="s1">&#39;vasp&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>For VASP format, the keyword argument of <code class="docutils literal notranslate"><span class="pre">interface_mode</span></code> can be omitted. For
QE,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">unitcell</span><span class="p">,</span> <span class="n">optional_structure_info</span> <span class="o">=</span> <span class="n">read_crystal_structure</span><span class="p">(</span><span class="s2">&quot;NaCl.in&quot;</span><span class="p">,</span> <span class="n">interface_mode</span><span class="o">=</span><span class="s1">&#39;qe&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">read_crystal_structure</span></code> returns a tuple and the first element is the
<code class="docutils literal notranslate"><span class="pre">PhonopyAtoms</span></code> instance.</p>
</section>
<section id="work-flow">
<h2>Work flow<a class="headerlink" href="#work-flow" title="Link to this heading">#</a></h2>
<p>The work flow is schematically shown in <a class="reference internal" href="workflow.html#workflow"><span class="std std-ref">Work flow</span></a>.</p>
<section id="pre-process">
<h3>Pre-process<a class="headerlink" href="#pre-process" title="Link to this heading">#</a></h3>
<p>The first step is to create a <code class="docutils literal notranslate"><span class="pre">Phonopy</span></code> object with at least two arguments, a
unit cell (<code class="docutils literal notranslate"><span class="pre">PhonopyAtoms</span></code> object, see <a class="reference internal" href="#phonopy-atoms"><span class="std std-ref">PhonopyAtoms class</span></a>) and a supercell
matrix (3x3 array, see <a class="reference internal" href="#variable-supercell-matrix"><span class="std std-ref">Supercell matrix</span></a>). In the following
example, a <span class="math notranslate nohighlight">\(2\times 2\times 2\)</span> supercell is created. The displacements to
be introduced to the supercell are internally generated by the
<code class="docutils literal notranslate"><span class="pre">generate_displacements()</span></code> method with the <code class="docutils literal notranslate"><span class="pre">distance</span></code> keyword argument. The
supercells with displacements are obtained by
<code class="docutils literal notranslate"><span class="pre">get_supercells_with_displacements()</span></code> method as a list of <code class="docutils literal notranslate"><span class="pre">PhonopyAtoms</span></code>
objects.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">phonopy</span><span class="w"> </span><span class="kn">import</span> <span class="n">Phonopy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">phonopy.structure.atoms</span><span class="w"> </span><span class="kn">import</span> <span class="n">PhonopyAtoms</span>

<span class="n">a</span> <span class="o">=</span> <span class="mf">5.404</span>
<span class="n">unitcell</span> <span class="o">=</span> <span class="n">PhonopyAtoms</span><span class="p">(</span><span class="n">symbols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Si&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">8</span><span class="p">,</span>
                        <span class="n">cell</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">a</span><span class="p">),</span>
                        <span class="n">scaled_positions</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                                          <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                          <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                          <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                                          <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span>
                                          <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">],</span>
                                          <span class="p">[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">],</span>
                                          <span class="p">[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">]])</span>
<span class="n">phonon</span> <span class="o">=</span> <span class="n">Phonopy</span><span class="p">(</span><span class="n">unitcell</span><span class="p">,</span>
                 <span class="n">supercell_matrix</span><span class="o">=</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span>
                 <span class="n">primitive_matrix</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                   <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                                   <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">phonon</span><span class="o">.</span><span class="n">generate_displacements</span><span class="p">(</span><span class="n">distance</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>
<span class="n">supercells</span> <span class="o">=</span> <span class="n">phonon</span><span class="o">.</span><span class="n">supercells_with_displacements</span>
</pre></div>
</div>
<p>In this example, the displacement distance is set to 0.03 (in Angstrom if the
crystal structure uses the Angstrom unit and the default value is 0.01.) The
supercells with displacements are given as a list of <code class="docutils literal notranslate"><span class="pre">PhonopyAtoms</span></code>. See
<a class="reference internal" href="#phonopy-read-write-structure"><span class="std std-ref">Read and write crystal structures</span></a> to write
those into files in a crystal structure format.</p>
<section id="calculators">
<h4>Calculators<a class="headerlink" href="#calculators" title="Link to this heading">#</a></h4>
<p>If not using the default calculator (<code class="docutils literal notranslate"><span class="pre">&quot;vasp&quot;</span></code>), the <code class="docutils literal notranslate"><span class="pre">calculator</span></code> keyword argument
must also be set in your instance of <code class="docutils literal notranslate"><span class="pre">Phonopy</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">Phonopy(...,</span> <span class="pre">calculator=&quot;qe&quot;)</span></code>).</p>
<p>The range of supported calculators use different units internally. If not using VASP,
set <code class="docutils literal notranslate"><span class="pre">set_factor_by_calculator</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code> for correct unit conversion. Some more
information on physical unit conversion is found at
<a class="reference internal" href="setting-tags.html#frequency-conversion-factor-tag"><span class="std std-ref">FREQUENCY_CONVERSION_FACTOR</span></a>, <a class="reference internal" href="formulation.html#physical-unit-conversion"><span class="std std-ref">Physical unit conversion</span></a>, and
<a class="reference internal" href="interfaces.html#calculator-interfaces"><span class="std std-ref">Interfaces to calculators</span></a>.</p>
</section>
<section id="pre-processing-example">
<h4>Pre-processing Example<a class="headerlink" href="#pre-processing-example" title="Link to this heading">#</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">phonopy</span><span class="w"> </span><span class="kn">import</span> <span class="n">Phonopy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">phonopy.structure.atoms</span><span class="w"> </span><span class="kn">import</span> <span class="n">PhonopyAtoms</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">phonopy.interface.calculator</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">read_crystal_structure</span><span class="p">,</span>
    <span class="n">write_crystal_structure</span><span class="p">,</span>
    <span class="n">get_calculator_physical_units</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">calc</span> <span class="o">=</span> <span class="s2">&quot;qe&quot;</span>  <span class="c1"># Quantum Espresso</span>
<span class="n">unitcell</span><span class="p">,</span> <span class="n">optional_structure_info</span> <span class="o">=</span> <span class="n">read_crystal_structure</span><span class="p">(</span><span class="s2">&quot;pw.in&quot;</span><span class="p">,</span>
    <span class="n">interface_mode</span><span class="o">=</span><span class="n">calc</span><span class="p">)</span>

<span class="n">phonon</span> <span class="o">=</span> <span class="n">Phonopy</span><span class="p">(</span><span class="n">unitcell</span><span class="p">,</span> <span class="n">supercell_matrix</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">calculator</span><span class="o">=</span><span class="n">calc</span><span class="p">,</span>
    <span class="n">set_factor_by_calculator</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">phonon</span><span class="o">.</span><span class="n">generate_displacements</span><span class="p">(</span><span class="n">distance</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>
<span class="n">supercells</span> <span class="o">=</span> <span class="n">phonon</span><span class="o">.</span><span class="n">supercells_with_displacements</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">supercell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">supercells</span><span class="p">):</span>
    <span class="n">write_crystal_structure</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;supercell-</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.in&quot;</span><span class="p">,</span>
        <span class="n">supercell</span><span class="p">,</span>
        <span class="n">interface_mode</span><span class="o">=</span><span class="n">calc</span><span class="p">,</span>
        <span class="n">optional_structure_info</span><span class="o">=</span><span class="n">optional_structure_info</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">phonon</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;phonopy_disp.yaml&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="post-process">
<h3>Post process<a class="headerlink" href="#post-process" title="Link to this heading">#</a></h3>
<p>Forces on atoms are supposed to be obtained by running force calculator (e.g.
VASP) with each supercell with a displacement. Then the forces in the
calculation outputs have to be collected by users. However output parsers for
selected calculators are found under <code class="docutils literal notranslate"><span class="pre">phonopy.interface</span></code>, which may be useful.
The forces have to be stored in a specific structure: a numpy array (or nested
list) as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="p">[</span> <span class="p">[</span> <span class="n">f_1x</span><span class="p">,</span> <span class="n">f_1y</span><span class="p">,</span> <span class="n">f_1z</span> <span class="p">],</span> <span class="p">[</span> <span class="n">f_2x</span><span class="p">,</span> <span class="n">f_2y</span><span class="p">,</span> <span class="n">f_2z</span> <span class="p">],</span> <span class="o">...</span> <span class="p">],</span> <span class="c1"># first supercell</span>
  <span class="p">[</span> <span class="p">[</span> <span class="n">f_1x</span><span class="p">,</span> <span class="n">f_1y</span><span class="p">,</span> <span class="n">f_1z</span> <span class="p">],</span> <span class="p">[</span> <span class="n">f_2x</span><span class="p">,</span> <span class="n">f_2y</span><span class="p">,</span> <span class="n">f_2z</span> <span class="p">],</span> <span class="o">...</span> <span class="p">],</span> <span class="c1"># second supercell</span>
  <span class="o">...</span>                                                   <span class="p">]</span>
</pre></div>
</div>
<p>This array (<code class="docutils literal notranslate"><span class="pre">sets_of_forces</span></code>) is set to the <code class="docutils literal notranslate"><span class="pre">Phonopy</span></code> object by:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phonon</span><span class="o">.</span><span class="n">forces</span> <span class="o">=</span> <span class="n">sets_of_forces</span>
</pre></div>
</div>
<p>This is the case when the set of atomic displacements is generated internally.
The information of displacements is already stored in the <code class="docutils literal notranslate"><span class="pre">Phonopy</span></code> object. But
if you want to input the forces together with the corresponding custom set of
displacements, <code class="docutils literal notranslate"><span class="pre">displacement_dataset</span></code> has to be prepared as a python dictionary
as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">displacement_dataset</span> <span class="o">=</span>
   <span class="p">{</span><span class="s1">&#39;natom&#39;</span><span class="p">:</span> <span class="n">number_of_atoms_in_supercell</span><span class="p">,</span>
    <span class="s1">&#39;first_atoms&#39;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span><span class="s1">&#39;number&#39;</span><span class="p">:</span> <span class="n">atom</span> <span class="n">index</span> <span class="n">of</span> <span class="n">displaced</span> <span class="n">atom</span> <span class="p">(</span><span class="n">starting</span> <span class="k">with</span> <span class="mi">0</span><span class="p">),</span>
       <span class="s1">&#39;displacement&#39;</span><span class="p">:</span> <span class="n">displacement</span> <span class="ow">in</span> <span class="n">Cartesian</span> <span class="n">coordinates</span><span class="p">,</span>
       <span class="s1">&#39;forces&#39;</span><span class="p">:</span> <span class="n">forces</span> <span class="n">on</span> <span class="n">atoms</span> <span class="ow">in</span> <span class="n">supercell</span><span class="p">},</span>
      <span class="p">{</span><span class="o">...</span><span class="p">},</span> <span class="o">...</span><span class="p">]}</span>
</pre></div>
</div>
<p>This is set to the <code class="docutils literal notranslate"><span class="pre">Phonopy</span></code> object by:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phonon</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">displacement_dataset</span>
</pre></div>
</div>
<p>From the set of displacements and forces, force constants internally with
calculated supercell sets of forces by</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phonon</span><span class="o">.</span><span class="n">produce_force_constants</span><span class="p">()</span>
</pre></div>
</div>
<p>If you have force constants and don‚Äôt need to create force constants from forces
and displacements, simply set your force constants by</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phonon</span><span class="o">.</span><span class="n">force_constants</span> <span class="o">=</span> <span class="n">force_constants</span>
</pre></div>
</div>
<p>The force constants matrix is given in 4 dimensional array (better to be a numpy
array of <code class="docutils literal notranslate"><span class="pre">dtype='double',</span> <span class="pre">order='C'</span></code>). The shape of force constants matrix is
<code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">N,</span> <span class="pre">3,</span> <span class="pre">3)</span></code> where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the number of atoms in the supercell and 3 gives
Cartesian axes. The compact force constants matrix with <code class="docutils literal notranslate"><span class="pre">(Np,</span> <span class="pre">N,</span> <span class="pre">3,</span> <span class="pre">3)</span></code> where
<code class="docutils literal notranslate"><span class="pre">Np</span></code> is the number of atoms in the primitive cell is also supported. See the
details at <a class="reference internal" href="input-files.html#file-force-constants"><span class="std std-ref">FORCE_CONSTANTS and force_constants.hdf5</span></a>.</p>
</section>
</section>
<section id="phonon-calculation">
<h2>Phonon calculation<a class="headerlink" href="#phonon-calculation" title="Link to this heading">#</a></h2>
<section id="save-parameters-phonopy-save">
<span id="phonopy-save-parameters"></span><h3>Save parameters (<code class="docutils literal notranslate"><span class="pre">phonopy.save</span></code>)<a class="headerlink" href="#save-parameters-phonopy-save" title="Link to this heading">#</a></h3>
<p>Basic information and parameters needed for phonon calculation are saved into a
file by <code class="docutils literal notranslate"><span class="pre">phonopy.save</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phonon</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<p>Force sets, displacements, Born effective charges, and dielectric constant
are written in the default behaviour.</p>
<p>The default file name is <code class="docutils literal notranslate"><span class="pre">phonopy_params.yaml</span></code>, but this can be changed with the
<code class="docutils literal notranslate"><span class="pre">filename</span></code> keword argument, which may be necessary if using certain CUI commands
that expect a particular filename</p>
<p>The force constants can be written as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phonon</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;force_constants&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</section>
<section id="band-structure">
<h3>Band structure<a class="headerlink" href="#band-structure" title="Link to this heading">#</a></h3>
<p>Set band paths (<code class="docutils literal notranslate"><span class="pre">run_band_structure()</span></code>) and get the results
(<code class="docutils literal notranslate"><span class="pre">get_band_structure_dict()</span></code>).</p>
<p>A dictionary with <code class="docutils literal notranslate"><span class="pre">qpoints</span></code>, <code class="docutils literal notranslate"><span class="pre">distances</span></code>, <code class="docutils literal notranslate"><span class="pre">frequencies</span></code>, <code class="docutils literal notranslate"><span class="pre">eigenvectors</span></code>,
<code class="docutils literal notranslate"><span class="pre">group_velocities</span></code> is returned by <code class="docutils literal notranslate"><span class="pre">get_band_structure_dict()</span></code>. Eigenvectors can
be obtained when <code class="docutils literal notranslate"><span class="pre">with_eigenvectors=True</span></code> at <code class="docutils literal notranslate"><span class="pre">run_band_structure()</span></code>. See the
details at docstring of <code class="docutils literal notranslate"><span class="pre">Phonopy.get_band_structure_dict</span></code>. Phonon frequency is
sqrt(eigenvalue). A negative eigenvalue has to correspond to the imaginary
frequency, but for the plotting, it is set as the negative value in the above
example. In addition, you need to multiply by your unit conversion factor. In
the case of VASP to transform to THz, the factor is 15.633302.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">example/NaCl</span></code>, the phonopy is executed from python script, e.g.,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">phonopy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">phonopy.phonon.band_structure</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_band_qpoints_and_path_connections</span>

<span class="n">path</span> <span class="o">=</span> <span class="p">[[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.625</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.625</span><span class="p">]],</span>
        <span class="p">[[</span><span class="mf">0.375</span><span class="p">,</span> <span class="mf">0.375</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]]]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">Gamma$&quot;</span><span class="p">,</span> <span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;U&quot;</span><span class="p">,</span> <span class="s2">&quot;K&quot;</span><span class="p">,</span> <span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">Gamma$&quot;</span><span class="p">,</span> <span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="s2">&quot;W&quot;</span><span class="p">]</span>
<span class="n">qpoints</span><span class="p">,</span> <span class="n">connections</span> <span class="o">=</span> <span class="n">get_band_qpoints_and_path_connections</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">npoints</span><span class="o">=</span><span class="mi">51</span><span class="p">)</span>
<span class="n">phonon</span> <span class="o">=</span> <span class="n">phonopy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;phonopy_disp.yaml&quot;</span><span class="p">)</span>
<span class="n">phonon</span><span class="o">.</span><span class="n">run_band_structure</span><span class="p">(</span><span class="n">qpoints</span><span class="p">,</span> <span class="n">path_connections</span><span class="o">=</span><span class="n">connections</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">phonon</span><span class="o">.</span><span class="n">plot_band_structure</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># To plot DOS next to band structure</span>
<span class="n">phonon</span><span class="o">.</span><span class="n">run_mesh</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
<span class="n">phonon</span><span class="o">.</span><span class="n">run_total_dos</span><span class="p">()</span>
<span class="n">phonon</span><span class="o">.</span><span class="n">plot_band_structure_and_dos</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># To plot PDOS next to band structure</span>
<span class="n">phonon</span><span class="o">.</span><span class="n">run_mesh</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="n">with_eigenvectors</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_mesh_symmetry</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">phonon</span><span class="o">.</span><span class="n">run_projected_dos</span><span class="p">()</span>
<span class="n">phonon</span><span class="o">.</span><span class="n">plot_band_structure_and_dos</span><span class="p">(</span><span class="n">pdos_indices</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">path_connections</span></code> and <code class="docutils literal notranslate"><span class="pre">labels</span></code> are optional unless nice looking
plotting is needed. To obtain eigenvectors, the corresponding
keyword argument must be set:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phonon</span><span class="o">.</span><span class="n">run_band_structure</span><span class="p">(</span><span class="n">bands</span><span class="p">,</span> <span class="n">with_eigenvectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>To obtain group velocities:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phonon</span><span class="o">.</span><span class="n">run_band_structure</span><span class="p">(</span><span class="n">bands</span><span class="p">,</span> <span class="n">with_group_velocities</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Automatic selection of band paths using
<a class="reference external" href="https://seekpath.readthedocs.io/en/latest/">SeeK-path</a> is invoked by</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phonon</span><span class="o">.</span><span class="n">auto_band_structure</span><span class="p">()</span>
</pre></div>
</div>
<p>and to plot</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phonon</span><span class="o">.</span><span class="n">auto_band_structure</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>To use this method, <code class="docutils literal notranslate"><span class="pre">seekpath</span></code> python module is needed.</p>
</section>
<section id="mesh-sampling">
<h3>Mesh sampling<a class="headerlink" href="#mesh-sampling" title="Link to this heading">#</a></h3>
<p>Set sampling mesh (<code class="docutils literal notranslate"><span class="pre">set_mesh</span></code>) in reciprocal space. The irreducible <em>q</em>-points
and corresponding <em>q</em>-point weights, eigenvalues, and eigenvectors are obtained
by <code class="docutils literal notranslate"><span class="pre">get_mesh_dict()</span></code>. <code class="docutils literal notranslate"><span class="pre">mesh</span></code> gives the sampling mesh with Monkhorst-Pack scheme.
The keyword <code class="docutils literal notranslate"><span class="pre">shift</span></code> gives the fractional mesh shift with respect to the
neighboring grid points.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mesh</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">phonon</span><span class="o">.</span><span class="n">run_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="n">mesh_dict</span> <span class="o">=</span> <span class="n">phonon</span><span class="o">.</span><span class="n">get_mesh_dict</span><span class="p">()</span>
<span class="n">qpoints</span> <span class="o">=</span> <span class="n">mesh_dict</span><span class="p">[</span><span class="s1">&#39;qpoints&#39;</span><span class="p">]</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">mesh_dict</span><span class="p">[</span><span class="s1">&#39;weights&#39;</span><span class="p">]</span>
<span class="n">frequencies</span> <span class="o">=</span> <span class="n">mesh_dict</span><span class="p">[</span><span class="s1">&#39;frequencies&#39;</span><span class="p">]</span>
<span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">mesh_dict</span><span class="p">[</span><span class="s1">&#39;eigenvectors&#39;</span><span class="p">]</span>
<span class="n">group_velocities</span> <span class="o">=</span> <span class="n">mesh_dict</span><span class="p">[</span><span class="s1">&#39;group_velocities&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>To obtain eigenvectors, the corresponding keyword argument must be set:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phonon</span><span class="o">.</span><span class="n">run_mesh</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="n">with_eigenvectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>and for group velocities:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phonon</span><span class="o">.</span><span class="n">run_mesh</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="n">with_group_velocities</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The first argument of <code class="docutils literal notranslate"><span class="pre">run_mesh()</span></code> can be a float value, which is a length
measure as explained at <a class="reference internal" href="setting-tags.html#mesh-tag"><span class="std std-ref">MESH, MP, or MESH_NUMBERS</span></a>, for example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phonon</span><span class="o">.</span><span class="n">run_mesh</span><span class="p">(</span><span class="mf">100.0</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="dos-and-pdos">
<h3>DOS and PDOS<a class="headerlink" href="#dos-and-pdos" title="Link to this heading">#</a></h3>
<p>Before starting mesh sampling has to be finished. Then set parameters
(<code class="docutils literal notranslate"><span class="pre">run_total_dos()</span></code> or <code class="docutils literal notranslate"><span class="pre">run_projected_dos()</span></code>) and write the results into files
(<code class="docutils literal notranslate"><span class="pre">write_total_dos()</span></code> and <code class="docutils literal notranslate"><span class="pre">write_projected_dos()</span></code>). In the case of PDOS, the
eigenvectors have to be calculated in the mesh sampling. To get the results
<code class="docutils literal notranslate"><span class="pre">get_total_dos_dict()</span></code> and <code class="docutils literal notranslate"><span class="pre">get_projected_dos_dict()</span></code> can be used.</p>
<p>To plot total DOS,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phonon</span><span class="o">.</span><span class="n">run_mesh</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span> <span class="n">phonon</span><span class="o">.</span><span class="n">run_total_dos</span><span class="p">()</span>
<span class="n">phonon</span><span class="o">.</span><span class="n">plot_total_dos</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>and projected DOS</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phonon</span><span class="o">.</span><span class="n">run_mesh</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="n">with_eigenvectors</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_mesh_symmetry</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">phonon</span><span class="o">.</span><span class="n">run_projected_dos</span><span class="p">()</span>
<span class="n">phonon</span><span class="o">.</span><span class="n">plot_projected_dos</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Convenient shortcuts exist as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phonon</span><span class="o">.</span><span class="n">auto_total_dos</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>and</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phonon</span><span class="o">.</span><span class="n">auto_projected_dos</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="thermal-properties">
<h3>Thermal properties<a class="headerlink" href="#thermal-properties" title="Link to this heading">#</a></h3>
<p>Before starting the thermal property calculation, the mesh sampling calculation
has to be done in the <strong>THz unit</strong>. The unit conversion factor for phonon
frequency is set in the pre-process of Phonopy with the <code class="docutils literal notranslate"><span class="pre">factor</span></code> keyword.
Calculation range of temperature is set by the parameters
<code class="docutils literal notranslate"><span class="pre">run_thermal_properties</span></code>. Helmholtz free energy, entropy, heat capacity at
constant volume at temperatures are obtained by <code class="docutils literal notranslate"><span class="pre">get_thermal_properties_dict</span></code>,
where the results are given as a dictionary of temperatures, Helmholtz free
energy, entropy, and heat capacity with keys <code class="docutils literal notranslate"><span class="pre">temperatures</span></code>, <code class="docutils literal notranslate"><span class="pre">free_energy</span></code>,
<code class="docutils literal notranslate"><span class="pre">entropy</span></code>, and <code class="docutils literal notranslate"><span class="pre">heat_capacity</span></code>, respectively.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phonon</span><span class="o">.</span><span class="n">run_mesh</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
<span class="n">phonon</span><span class="o">.</span><span class="n">run_thermal_properties</span><span class="p">(</span><span class="n">t_step</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                              <span class="n">t_max</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                              <span class="n">t_min</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">tp_dict</span> <span class="o">=</span> <span class="n">phonon</span><span class="o">.</span><span class="n">get_thermal_properties_dict</span><span class="p">()</span>
<span class="n">temperatures</span> <span class="o">=</span> <span class="n">tp_dict</span><span class="p">[</span><span class="s1">&#39;temperatures&#39;</span><span class="p">]</span>
<span class="n">free_energy</span> <span class="o">=</span> <span class="n">tp_dict</span><span class="p">[</span><span class="s1">&#39;free_energy&#39;</span><span class="p">]</span>
<span class="n">entropy</span> <span class="o">=</span> <span class="n">tp_dict</span><span class="p">[</span><span class="s1">&#39;entropy&#39;</span><span class="p">]</span>
<span class="n">heat_capacity</span> <span class="o">=</span> <span class="n">tp_dict</span><span class="p">[</span><span class="s1">&#39;heat_capacity&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">cv</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">temperatures</span><span class="p">,</span> <span class="n">free_energy</span><span class="p">,</span> <span class="n">entropy</span><span class="p">,</span> <span class="n">heat_capacity</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">((</span><span class="s2">&quot;</span><span class="si">%12.3f</span><span class="s2"> &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%15.7f</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span> <span class="n">t</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">cv</span> <span class="p">))</span>

<span class="n">phonon</span><span class="o">.</span><span class="n">plot_thermal_properties</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="non-analytical-term-correction">
<h3>Non-analytical term correction<a class="headerlink" href="#non-analytical-term-correction" title="Link to this heading">#</a></h3>
<p>To apply non-analytical term correction, Born effective charge tensors for all
atoms in <strong>primitive</strong> cell, dielectric constant tensor, and the unit conversion
factor have to be correctly set. The tensors are given in Cartesian coordinates.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">born</span> <span class="o">=</span> <span class="p">[[[</span><span class="mf">1.08878299</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.08878299</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.08878299</span><span class="p">]],</span>
        <span class="p">[[</span><span class="o">-</span><span class="mf">1.08878299</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.08878299</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.08878299</span><span class="p">]]]</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">2.56544559</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
           <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.56544559</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
           <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">2.56544559</span><span class="p">]]</span>
<span class="n">factors</span> <span class="o">=</span> <span class="mf">14.400</span>
<span class="n">phonon</span><span class="o">.</span><span class="n">nac_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;born&#39;</span><span class="p">:</span> <span class="n">born</span><span class="p">,</span>
                     <span class="s1">&#39;factor&#39;</span><span class="p">:</span> <span class="n">factors</span><span class="p">,</span>
                     <span class="s1">&#39;dielectric&#39;</span><span class="p">:</span> <span class="n">epsilon</span><span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="data-structure">
<h2>Data structure<a class="headerlink" href="#data-structure" title="Link to this heading">#</a></h2>
<section id="eigenvectors">
<h3>Eigenvectors<a class="headerlink" href="#eigenvectors" title="Link to this heading">#</a></h3>
<p>Eigenvectors are given as the column vectors. Internally phonopy uses
<code class="docutils literal notranslate"><span class="pre">numpy.linalg.eigh</span></code> and <code class="docutils literal notranslate"><span class="pre">eigh</span></code> is a wrapper of LAPACK. So eigenvectors follow
the convention of LAPACK, which can be shown at
<a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.eigh.html">http://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.eigh.html</a></p>
<p>Eigenvectors corresponding to phonopy yaml output are obtained as follows.</p>
<section id="id1">
<h4>Band structure<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">eigvecs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">eigvecs_on_path</span> <span class="ow">in</span> <span class="n">eigvecs</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">eigvecs_at_q</span> <span class="ow">in</span> <span class="n">eigvecs_on_path</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">eigvecs_at_q</span><span class="o">.</span><span class="n">T</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id2">
<h4>Mesh sampling<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">eigvecs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">eigvecs_at_q</span> <span class="ow">in</span> <span class="n">eigvecs</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">eigvecs_at_q</span><span class="o">.</span><span class="n">T</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="phonopyatoms-class">
<span id="phonopy-atoms"></span><h2><code class="docutils literal notranslate"><span class="pre">PhonopyAtoms</span></code> class<a class="headerlink" href="#phonopyatoms-class" title="Link to this heading">#</a></h2>
<section id="initialization">
<h3>Initialization<a class="headerlink" href="#initialization" title="Link to this heading">#</a></h3>
<p>The usable keywords in the initialization are:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cell</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="n">scaled_positions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="n">positions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="n">numbers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="n">symbols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="n">masses</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="n">magnetic_moments</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</pre></div>
</div>
<p>At least three arguments have to be given at the initialization, which are</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cell</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">positions</span></code> or <code class="docutils literal notranslate"><span class="pre">scaled_positions</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">symbols</span></code> or <code class="docutils literal notranslate"><span class="pre">numbers</span></code></p></li>
</ul>
</section>
<section id="variables">
<span id="phonopy-atoms-variables"></span><h3>Variables<a class="headerlink" href="#variables" title="Link to this heading">#</a></h3>
<p>The following variables are implemented in the <code class="docutils literal notranslate"><span class="pre">PhonopyAtoms</span></code> class in
<code class="docutils literal notranslate"><span class="pre">phonopy/structure/atoms.py</span></code>.</p>
<section id="cell">
<span id="phonopy-atoms-cell"></span><h4><code class="docutils literal notranslate"><span class="pre">cell</span></code><a class="headerlink" href="#cell" title="Link to this heading">#</a></h4>
<p>Basis vectors are given in the matrix form in Cartesian coordinates.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="p">[</span> <span class="n">a_x</span><span class="p">,</span> <span class="n">a_y</span><span class="p">,</span> <span class="n">a_z</span> <span class="p">],</span> <span class="p">[</span> <span class="n">b_x</span><span class="p">,</span> <span class="n">b_y</span><span class="p">,</span> <span class="n">b_z</span> <span class="p">],</span> <span class="p">[</span> <span class="n">c_x</span><span class="p">,</span> <span class="n">c_y</span><span class="p">,</span> <span class="n">c_z</span> <span class="p">]</span> <span class="p">]</span>
</pre></div>
</div>
</section>
<section id="scaled-positions">
<h4><code class="docutils literal notranslate"><span class="pre">scaled_positions</span></code><a class="headerlink" href="#scaled-positions" title="Link to this heading">#</a></h4>
<p>Atomic positions in fractional coordinates.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="p">[</span> <span class="n">x1_a</span><span class="p">,</span> <span class="n">x1_b</span><span class="p">,</span> <span class="n">x1_c</span> <span class="p">],</span> <span class="p">[</span> <span class="n">x2_a</span><span class="p">,</span> <span class="n">x2_b</span><span class="p">,</span> <span class="n">x2_c</span> <span class="p">],</span> <span class="p">[</span> <span class="n">x3_a</span><span class="p">,</span> <span class="n">x3_b</span><span class="p">,</span> <span class="n">x3_c</span> <span class="p">],</span> <span class="o">...</span> <span class="p">]</span>
</pre></div>
</div>
</section>
<section id="positions">
<h4><code class="docutils literal notranslate"><span class="pre">positions</span></code><a class="headerlink" href="#positions" title="Link to this heading">#</a></h4>
<p>Cartesian positions of atoms.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">scaled_positions</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">np</span></code> means the numpy module (<code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np</span></code>).</p>
</section>
<section id="symbols">
<h4><code class="docutils literal notranslate"><span class="pre">symbols</span></code><a class="headerlink" href="#symbols" title="Link to this heading">#</a></h4>
<p>Chemical symbols, e.g.,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;Zn&#39;</span><span class="p">,</span> <span class="s1">&#39;Zn&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>for the ZnO unit cell.</p>
</section>
<section id="numbers">
<h4><code class="docutils literal notranslate"><span class="pre">numbers</span></code><a class="headerlink" href="#numbers" title="Link to this heading">#</a></h4>
<p>Atomic numbers, e.g.,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
<p>for the ZnO unit cell.</p>
</section>
<section id="masses">
<h4><code class="docutils literal notranslate"><span class="pre">masses</span></code><a class="headerlink" href="#masses" title="Link to this heading">#</a></h4>
<p>Atomic masses, e.g.,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mf">65.38</span><span class="p">,</span> <span class="mf">65.38</span><span class="p">,</span> <span class="mf">15.9994</span><span class="p">,</span> <span class="mf">15.9994</span><span class="p">]</span>
</pre></div>
</div>
<p>for the ZnO unit cell.</p>
</section>
</section>
<section id="attributes">
<h3>Attributes<a class="headerlink" href="#attributes" title="Link to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell</span>
<span class="n">positions</span>
<span class="n">scaled_positions</span>
<span class="n">masses</span>
<span class="n">magnetic_moments</span>
<span class="n">symbols</span>
<span class="n">numbers</span>
<span class="n">volume</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">volume</span></code> is the getter only.</p>
</section>
<section id="methods">
<h3>Methods<a class="headerlink" href="#methods" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">unitcell.get_number_of_atoms()</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">len(unitcell)</span></code>. An instance
can be deep-copied by <code class="docutils literal notranslate"><span class="pre">unitcell.copy()</span></code>. Human-readable crystal structure in
Yaml format is shown by <code class="docutils literal notranslate"><span class="pre">print(unitcell)</span></code>. <code class="docutils literal notranslate"><span class="pre">unitcell.to_tuple</span></code> converts to
spglib crystal structure
(<a class="reference external" href="https://spglib.github.io/spglib/python-spglib.html#crystal-structure-cell">https://spglib.github.io/spglib/python-spglib.html#crystal-structure-cell</a>).</p>
</section>
</section>
<section id="definitions-of-variables">
<h2>Definitions of variables<a class="headerlink" href="#definitions-of-variables" title="Link to this heading">#</a></h2>
<section id="supercell-matrix">
<span id="variable-supercell-matrix"></span><h3>Supercell matrix<a class="headerlink" href="#supercell-matrix" title="Link to this heading">#</a></h3>
<p>Supercell matrix <span class="math notranslate nohighlight">\(\mathrm{M}_\mathrm{s}\)</span> is a transformation matrix from lattice
vectors to those of a super cell. Following a crystallography convention, the
transformation is given by</p>
<div class="math notranslate nohighlight">
\[( \mathbf{a}_\mathrm{s} \; \mathbf{b}_\mathrm{s} \; \mathbf{c}_\mathrm{s} ) = (
\mathbf{a}_\mathrm{u} \; \mathbf{b}_\mathrm{u} \; \mathbf{c}_\mathrm{u} )
\mathrm{M}_\mathrm{s}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{a}_\mathrm{u}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{b}_\mathrm{u}\)</span>, and
<span class="math notranslate nohighlight">\(\mathbf{c}_\mathrm{u}\)</span> are the column vectors of the original lattice
vectors, and <span class="math notranslate nohighlight">\(\mathbf{a}_\mathrm{s}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{b}_\mathrm{s}\)</span>, and
<span class="math notranslate nohighlight">\(\mathbf{c}_\mathrm{s}\)</span> are the column vectors of the supercell lattice
vectors. Be careful that the lattice vectors of the <code class="docutils literal notranslate"><span class="pre">PhonopyAtoms</span></code> class are the
row vectors (<a class="reference internal" href="#phonopy-atoms-cell"><span class="std std-ref">cell</span></a>). Therefore the phonopy code, which
relies on the <code class="docutils literal notranslate"><span class="pre">PhonopyAtoms</span></code> class, is usually written such as</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">supercell_lattice</span> <span class="o">=</span> <span class="p">(</span><span class="n">original_lattice</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">supercell_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</pre></div>
</div>
</section>
<section id="primitive-matrix">
<span id="variable-primitive-matrix"></span><h3>Primitive matrix<a class="headerlink" href="#primitive-matrix" title="Link to this heading">#</a></h3>
<p>Primitive matrix <span class="math notranslate nohighlight">\(\mathrm{M}_\mathrm{p}\)</span> is a tranformation matrix from lattice
vectors to those of a primitive cell if there exists the primitive cell in the
lattice vectors. Following a crystallography convention, the transformation is
given by</p>
<div class="math notranslate nohighlight">
\[( \mathbf{a}_\mathrm{p} \; \mathbf{b}_\mathrm{p} \; \mathbf{c}_\mathrm{p} ) = (
\mathbf{a}_\mathrm{s} \; \mathbf{b}_\mathrm{s} \; \mathbf{c}_\mathrm{s} )
\mathrm{M}_\mathrm{s}^{-1} \mathrm{M}_\mathrm{p}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{a}_\mathrm{p}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{b}_\mathrm{p}\)</span>, and
<span class="math notranslate nohighlight">\(\mathbf{c}_\mathrm{p}\)</span> are the column vectors of the primitive lattice
vectors. Be careful that the lattice vectors of the <code class="docutils literal notranslate"><span class="pre">PhonopyAtoms</span></code> class are the
row vectors (<a class="reference internal" href="#phonopy-atoms-cell"><span class="std std-ref">cell</span></a>). Therefore the phonopy code, which
relies on the <code class="docutils literal notranslate"><span class="pre">PhonopyAtoms</span></code> class, is usually written such as</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">primitive_lattice</span> <span class="o">=</span> <span class="p">(</span><span class="n">supercell_lattice</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">supercell_matrix</span><span class="p">)</span> <span class="o">@</span> <span class="n">primitive_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</pre></div>
</div>
</section>
<section id="symmetry-search-tolerance">
<h3>Symmetry search tolerance<a class="headerlink" href="#symmetry-search-tolerance" title="Link to this heading">#</a></h3>
<p>Symmetry search tolerance (often the name <code class="docutils literal notranslate"><span class="pre">symprec</span></code> is used in phonopy) is used
to determine symmetry operations of the crystal structures. The physical unit
follows that of input crystal structure.</p>
</section>
</section>
<section id="load-phonopy-settings-phonopy-load">
<span id="phonopy-load"></span><h2>Load phonopy settings <code class="docutils literal notranslate"><span class="pre">phonopy.load</span></code><a class="headerlink" href="#load-phonopy-settings-phonopy-load" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">phonopy.load</span></code> is a convenient function that creates a <code class="docutils literal notranslate"><span class="pre">Phonopy</span></code> instance by
loading data from a <code class="docutils literal notranslate"><span class="pre">phonopy_xxx.yaml</span></code> file, which may include all the necessary
information to run phonopy. A typical usage is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">phonopy</span>
<span class="n">phonon</span> <span class="o">=</span> <span class="n">phonopy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;phonopy_params.yaml&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">phonopy_params.yaml</span></code> contains a displacement-force dataset and you want to
avoid producing force constants, set <code class="docutils literal notranslate"><span class="pre">produce_fc=False</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phonon</span> <span class="o">=</span> <span class="n">phonopy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;phonopy_params.yaml&quot;</span><span class="p">,</span> <span class="n">produce_fc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively, if you have either <code class="docutils literal notranslate"><span class="pre">phonopy.yaml</span></code> (or <code class="docutils literal notranslate"><span class="pre">phonopy_disp.yaml</span></code>) along
with a <code class="docutils literal notranslate"><span class="pre">FORCE_SETS</span></code> file, you can create a <code class="docutils literal notranslate"><span class="pre">Phonopy</span></code> object like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phonon</span> <span class="o">=</span> <span class="n">phonopy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;phonopy.yaml&quot;</span><span class="p">,</span> <span class="n">force_sets_filename</span><span class="o">=</span><span class="s2">&quot;FORCE_SETS&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case, the command reads the structure information from <code class="docutils literal notranslate"><span class="pre">phonopy.yaml</span></code>
and the displacement-force data from <code class="docutils literal notranslate"><span class="pre">FORCE_SETS</span></code> to create the <code class="docutils literal notranslate"><span class="pre">Phonopy</span></code>
instance.</p>
<p>If your current directory contains the following files:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>ls
BORN<span class="w">  </span>FORCE_SETS<span class="w">  </span>phonopy.yaml
</pre></div>
</div>
<p>then both the <code class="docutils literal notranslate"><span class="pre">BORN</span></code> and <code class="docutils literal notranslate"><span class="pre">FORCE_SETS</span></code> files will be read automatically by</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phonon</span> <span class="o">=</span> <span class="n">phonopy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;phonopy.yaml&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>For more details, see the function‚Äôs docstring:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">import</span><span class="w"> </span><span class="nn">phonopy</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">help</span><span class="p">(</span><span class="n">phonopy</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="read-and-write-crystal-structures">
<span id="phonopy-read-write-structure"></span><h2>Read and write crystal structures<a class="headerlink" href="#read-and-write-crystal-structures" title="Link to this heading">#</a></h2>
<p>There is a function to write the <code class="docutils literal notranslate"><span class="pre">PhonopyAtoms</span></code> instance into crystal structure
formats of different force calculators, <code class="docutils literal notranslate"><span class="pre">write_crystal_structure</span></code>. This works as
a partner of <code class="docutils literal notranslate"><span class="pre">read_crystal_structure</span></code>. Taking an example of QE interface, how to
use these functions is shown below.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span><span class="w"> </span><span class="nn">phonopy.interface.calculator</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_crystal_structure</span><span class="p">,</span> <span class="n">write_crystal_structure</span>

<span class="gp">In [2]: </span><span class="o">!</span>cat<span class="w"> </span><span class="s2">&quot;NaCl.in&quot;</span>
<span class="go"> &amp;control</span>
<span class="go">    calculation = &#39;scf&#39;</span>
<span class="go">    tprnfor = .true.</span>
<span class="go">    tstress = .true.</span>
<span class="go">    pseudo_dir = &#39;/home/togo/espresso/pseudo/&#39;</span>
<span class="go"> /</span>
<span class="go"> &amp;system</span>
<span class="go">    ibrav = 0</span>
<span class="go">    nat = 8</span>
<span class="go">    ntyp = 2</span>
<span class="go">    ecutwfc = 70.0</span>
<span class="go"> /</span>
<span class="go"> &amp;electrons</span>
<span class="go">    diagonalization = &#39;david&#39;</span>
<span class="go">    conv_thr = 1.0d-9</span>
<span class="go"> /</span>
<span class="go">ATOMIC_SPECIES</span>
<span class="go"> Na  22.98976928 Na.pbe-spn-kjpaw_psl.0.2.UPF</span>
<span class="go"> Cl  35.453      Cl.pbe-n-kjpaw_psl.0.1.UPF</span>
<span class="go">ATOMIC_POSITIONS crystal</span>
<span class="go"> Na   0.0000000000000000  0.0000000000000000  0.0000000000000000</span>
<span class="go"> Na   0.0000000000000000  0.5000000000000000  0.5000000000000000</span>
<span class="go"> Na   0.5000000000000000  0.0000000000000000  0.5000000000000000</span>
<span class="go"> Na   0.5000000000000000  0.5000000000000000  0.0000000000000000</span>
<span class="go"> Cl   0.5000000000000000  0.5000000000000000  0.5000000000000000</span>
<span class="go"> Cl   0.5000000000000000  0.0000000000000000  0.0000000000000000</span>
<span class="go"> Cl   0.0000000000000000  0.5000000000000000  0.0000000000000000</span>
<span class="go"> Cl   0.0000000000000000  0.0000000000000000  0.5000000000000000</span>
<span class="go">CELL_PARAMETERS angstrom</span>
<span class="go"> 5.6903014761756712 0 0</span>
<span class="go"> 0 5.6903014761756712 0</span>
<span class="go"> 0 0 5.6903014761756712</span>
<span class="go">K_POINTS automatic</span>
<span class="go"> 8 8 8 1 1 1</span>

<span class="gp">In [3]: </span><span class="n">cell</span><span class="p">,</span> <span class="n">optional_structure_info</span> <span class="o">=</span> <span class="n">read_crystal_structure</span><span class="p">(</span><span class="s2">&quot;NaCl.in&quot;</span><span class="p">,</span> <span class="n">interface_mode</span><span class="o">=</span><span class="s1">&#39;qe&#39;</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">optional_structure_info</span>
<span class="gh">Out[4]:</span>
<span class="go">(&#39;NaCl.in&#39;,</span>
<span class="go"> {&#39;Na&#39;: &#39;Na.pbe-spn-kjpaw_psl.0.2.UPF&#39;, &#39;Cl&#39;: &#39;Cl.pbe-n-kjpaw_psl.0.1.UPF&#39;})</span>

<span class="gp">In [5]: </span><span class="n">write_crystal_structure</span><span class="p">(</span><span class="s2">&quot;NaCl-out.in&quot;</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">interface_mode</span><span class="o">=</span><span class="s1">&#39;qe&#39;</span><span class="p">,</span> <span class="n">optional_structure_info</span><span class="o">=</span><span class="n">optional_structure_info</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="o">!</span>cat<span class="w"> </span><span class="s2">&quot;NaCl-out.in&quot;</span>
<span class="go">!    ibrav = 0, nat = 8, ntyp = 2</span>
<span class="go">CELL_PARAMETERS bohr</span>
<span class="go">   10.7531114272216008    0.0000000000000000    0.0000000000000000</span>
<span class="go">    0.0000000000000000   10.7531114272216008    0.0000000000000000</span>
<span class="go">    0.0000000000000000    0.0000000000000000   10.7531114272216008</span>
<span class="go">ATOMIC_SPECIES</span>
<span class="go"> Na   22.98977   Na.pbe-spn-kjpaw_psl.0.2.UPF</span>
<span class="go"> Cl   35.45300   Cl.pbe-n-kjpaw_psl.0.1.UPF</span>
<span class="go">ATOMIC_POSITIONS crystal</span>
<span class="go"> Na   0.0000000000000000  0.0000000000000000  0.0000000000000000</span>
<span class="go"> Na   0.0000000000000000  0.5000000000000000  0.5000000000000000</span>
<span class="go"> Na   0.5000000000000000  0.0000000000000000  0.5000000000000000</span>
<span class="go"> Na   0.5000000000000000  0.5000000000000000  0.0000000000000000</span>
<span class="go"> Cl   0.5000000000000000  0.5000000000000000  0.5000000000000000</span>
<span class="go"> Cl   0.5000000000000000  0.0000000000000000  0.0000000000000000</span>
<span class="go"> Cl   0.0000000000000000  0.5000000000000000  0.0000000000000000</span>
<span class="go"> Cl   0.0000000000000000  0.0000000000000000  0.5000000000000000</span>
</pre></div>
</div>
<p>Depending on calculator interfaces, all the information can not be recovered
from the information obtained from <code class="docutils literal notranslate"><span class="pre">read_crystal_structure</span></code>. More details about
how <code class="docutils literal notranslate"><span class="pre">write_crystal_structure</span></code> works may need to read directly the
<a class="reference external" href="https://github.com/phonopy/phonopy/blob/develop/phonopy/interface/calculator.py#L123">code</a>.</p>
</section>
<section id="getting-parameters-for-non-analytical-term-correction">
<h2>Getting parameters for non-analytical term correction<a class="headerlink" href="#getting-parameters-for-non-analytical-term-correction" title="Link to this heading">#</a></h2>
<p>Parameters for non-analytical term correction may be made as follows. This
example assumes that the user knows what are the unit cell and primitive cell
and that the Born effective charge and dielectric constant were calculated using
VASP code by the unit cell.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">io</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">phonopy.physical_units</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_physical_units</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">phonopy.structure.symmetry</span><span class="w"> </span><span class="kn">import</span> <span class="n">symmetrize_borns_and_epsilon</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">phonopy.interface.vasp</span><span class="w"> </span><span class="kn">import</span> <span class="n">VasprunxmlExpat</span>

<span class="k">with</span> <span class="n">io</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;vasprun.xml&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">vasprun</span> <span class="o">=</span> <span class="n">VasprunxmlExpat</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">vasprun</span><span class="o">.</span><span class="n">parse</span><span class="p">():</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="n">vasprun</span><span class="o">.</span><span class="n">epsilon</span>
    <span class="n">borns</span> <span class="o">=</span> <span class="n">vasprun</span><span class="o">.</span><span class="n">born</span>
    <span class="n">unitcell</span> <span class="o">=</span> <span class="n">vasprun</span><span class="o">.</span><span class="n">cell</span>

<span class="n">borns_</span><span class="p">,</span> <span class="n">epsilon_</span> <span class="o">=</span> <span class="n">symmetrize_borns_and_epsilon</span><span class="p">(</span>
    <span class="n">borns</span><span class="p">,</span>
    <span class="n">epsilon</span><span class="p">,</span>
    <span class="n">unitcell</span><span class="p">,</span>
    <span class="n">primitive_matrix</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                      <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                      <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
    <span class="n">supercell_matrix</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
    <span class="n">symprec</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>

<span class="n">units</span> <span class="o">=</span> <span class="n">get_physical_units</span><span class="p">()</span>
<span class="n">nac_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;born&#39;</span><span class="p">:</span> <span class="n">borns_</span><span class="p">,</span>
              <span class="s1">&#39;factor&#39;</span><span class="p">:</span> <span class="n">units</span><span class="o">.</span><span class="n">Hartree</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">Bohr</span><span class="p">,</span>
              <span class="s1">&#39;dielectric&#39;</span><span class="p">:</span> <span class="n">epsilon_</span><span class="p">}</span>
</pre></div>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="external-tools.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">External tools</p>
      </div>
    </a>
    <a class="right-next"
       href="phonopy-yaml.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">phonopy-yaml format</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#three-unit-cells">Three unit cells</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-modules">Import modules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#work-flow">Work flow</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-process">Pre-process</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculators">Calculators</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-processing-example">Pre-processing Example</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#post-process">Post process</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#phonon-calculation">Phonon calculation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#save-parameters-phonopy-save">Save parameters (<code class="docutils literal notranslate"><span class="pre">phonopy.save</span></code>)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#band-structure">Band structure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mesh-sampling">Mesh sampling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dos-and-pdos">DOS and PDOS</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thermal-properties">Thermal properties</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#non-analytical-term-correction">Non-analytical term correction</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-structure">Data structure</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eigenvectors">Eigenvectors</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Band structure</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Mesh sampling</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#phonopyatoms-class"><code class="docutils literal notranslate"><span class="pre">PhonopyAtoms</span></code> class</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initialization">Initialization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variables">Variables</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cell"><code class="docutils literal notranslate"><span class="pre">cell</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#scaled-positions"><code class="docutils literal notranslate"><span class="pre">scaled_positions</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#positions"><code class="docutils literal notranslate"><span class="pre">positions</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#symbols"><code class="docutils literal notranslate"><span class="pre">symbols</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#numbers"><code class="docutils literal notranslate"><span class="pre">numbers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#masses"><code class="docutils literal notranslate"><span class="pre">masses</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#attributes">Attributes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#methods">Methods</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definitions-of-variables">Definitions of variables</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#supercell-matrix">Supercell matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#primitive-matrix">Primitive matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#symmetry-search-tolerance">Symmetry search tolerance</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-phonopy-settings-phonopy-load">Load phonopy settings <code class="docutils literal notranslate"><span class="pre">phonopy.load</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-and-write-crystal-structures">Read and write crystal structures</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-parameters-for-non-analytical-term-correction">Getting parameters for non-analytical term correction</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Author name not set
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2009, Atsushi Togo.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>