
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Quantum ESPRESSO (QE) &amp; phonopy calculation &#8212; Phonopy v.2.43.2</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=11fc04d2"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'qe';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Abinit &amp; phonopy calculation" href="abinit.html" />
    <link rel="prev" title="Wien2k &amp; phonopy calculation" href="wien2k.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Phonopy v.2.43.2</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="symmetry.html">Crystal symmetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">Work flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="input-files.html">Input files</a></li>
<li class="toctree-l1"><a class="reference internal" href="output-files.html">Output files</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="setting-tags.html">Setting tags</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="animation.html">How to watch animation</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="command-options.html">Command options</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamic-structure-factor.html">Dynamic structure factor</a></li>
<li class="toctree-l1"><a class="reference internal" href="gruneisen.html">Mode Gr√ºneisen parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="qha.html">Quasi harmonic approximation</a></li>
<li class="toctree-l1"><a class="reference internal" href="random-displacements.html">Random displacements</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="interfaces.html">Interfaces to calculators</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="vasp.html">VASP &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="wien2k.html">Wien2k &amp; phonopy calculation</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Quantum ESPRESSO (QE) &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="abinit.html">Abinit &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="siesta.html">Siesta &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="elk.html">Elk &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="crystal.html">CRYSTAL &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="dftb%2B.html">DFTB+ &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="turbomole.html">TURBOMOLE &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="cp2k.html">CP2K &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="aims.html">FHI-aims &amp; phonopy calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="castep.html">CASTEP &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Fleur.html">Fleur &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="abacus.html">ABACUS &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="lammps.html">LAMMPS &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="qlm.html">Questaal &amp; phonopy calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="vasp-dfpt.html">VASP-DFPT &amp; phonopy calculation</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="auxiliary-tools.html">Auxiliary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="external-tools.html">External tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="phonopy-module.html">Phonopy API for Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="phonopy-yaml.html">phonopy-yaml format</a></li>
<li class="toctree-l1"><a class="reference internal" href="phonopy-load.html">phonopy-load command</a></li>
<li class="toctree-l1"><a class="reference internal" href="mlp-sscha.html">Temperature dependent force constants calculation using pypolymlp and symfc</a></li>
<li class="toctree-l1"><a class="reference internal" href="formulation.html">Formulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">How to cite phonopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change Log</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/qe.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Quantum ESPRESSO (QE) & phonopy calculation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#supported-qe-pw-tags">Supported QE-PW tags</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-run">How to run</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#non-analytical-term-correction-optional">Non-analytical term correction (Optional)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-q2r-x-to-create-phonopy-force-constants-file">Using <code class="docutils literal notranslate"><span class="pre">q2r.x</span></code> to create phonopy force constants file</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#non-analytical-term-correction">Non-analytical term correction</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-born-file">Creating BORN file</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nacl-example">NaCl example</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="quantum-espresso-qe-phonopy-calculation">
<span id="qe-interface"></span><h1>Quantum ESPRESSO (QE) &amp; phonopy calculation<a class="headerlink" href="#quantum-espresso-qe-phonopy-calculation" title="Link to this heading">#</a></h1>
<p>Quantum ESPRESSO package itself has a set of the phonon calculation
system. But the document here explains how to calculate phonons using
phonopy, i.e., using the finite displacement and supercell approach.</p>
<section id="supported-qe-pw-tags">
<h2>Supported QE-PW tags<a class="headerlink" href="#supported-qe-pw-tags" title="Link to this heading">#</a></h2>
<p>Currently QE-PW tags that phonopy can read are shown below.  Only
<code class="docutils literal notranslate"><span class="pre">ibrav</span> <span class="pre">=</span> <span class="pre">0</span></code> type representation of crystal structure is supported.
More tags may be supported on request.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nat</span><span class="p">,</span> <span class="n">ntyp</span><span class="p">,</span> <span class="n">celldm</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">ATOMIC_SPECIES</span><span class="p">,</span> <span class="n">ATOMIC_POSITIONS</span><span class="p">,</span> <span class="n">CELL_PARAMETERS</span>
</pre></div>
</div>
<p>Chemical symbols with natural number for <code class="docutils literal notranslate"><span class="pre">ATOMIC_SPECIES</span></code> like <code class="docutils literal notranslate"><span class="pre">Xn</span></code> (<code class="docutils literal notranslate"><span class="pre">n&gt;0</span></code>),
e.g.. <code class="docutils literal notranslate"><span class="pre">Fe1</span></code>, can be used. The formats of <code class="docutils literal notranslate"><span class="pre">X_*</span></code> and <code class="docutils literal notranslate"><span class="pre">X-*</span></code> are not supported. When
this extended symbol is used, masses of all atoms including usual chemical
symbols are read from QE structure file. Otherwise, masses of respective
chemical symbols implemented in phonopy are used. Note that when using the
extended symbol, if the unit cell of QE structure file is not a primitive cell,
and the primitive cell is defined by the transformation matrix (<code class="docutils literal notranslate"><span class="pre">PRIMITIVE_AXES</span></code>
tag or <code class="docutils literal notranslate"><span class="pre">--pa</span></code> option), atoms with the extended symbols in the unit cell have to
be mapped properly to those in the primitive cell.</p>
</section>
<section id="how-to-run">
<h2>How to run<a class="headerlink" href="#how-to-run" title="Link to this heading">#</a></h2>
<p>The procedure of QE-phonopy calculation is shown below using the
NaCl example found in <code class="docutils literal notranslate"><span class="pre">example/NaCl-QE</span></code> directory.</p>
<ol class="arabic">
<li><p>Read a QE-PW input file and create supercells with
<a class="reference internal" href="command-options.html#qe-mode"><span class="std std-ref">--qe</span></a> option:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>phonopy<span class="w"> </span>--qe<span class="w"> </span>-d<span class="w"> </span>--dim<span class="o">=</span><span class="s2">&quot;2 2 2&quot;</span><span class="w"> </span>-c<span class="w"> </span>NaCl.in
</pre></div>
</div>
<p>In this example, 2x2x2 supercells are created. <code class="docutils literal notranslate"><span class="pre">supercell.in</span></code> and
<code class="docutils literal notranslate"><span class="pre">supercell-xxx.in</span></code> (<code class="docutils literal notranslate"><span class="pre">xxx</span></code> are numbers) give the perfect
supercell and supercells with displacements, respectively. In the
case of the NaCl example, two files <code class="docutils literal notranslate"><span class="pre">supercell-001.in</span></code> and
<code class="docutils literal notranslate"><span class="pre">supercell-002.in</span></code> are created. In these supercell files, lines
only relevant to crystal structures are
given. <code class="docutils literal notranslate"><span class="pre">phonopy_disp.yaml</span></code> is also generated, which contains
information about supercell and displacements.</p>
</li>
<li><p>To make QE-PW input files, necessary setting information is added to
<code class="docutils literal notranslate"><span class="pre">supercell-xxx.in</span></code> files, e.g., by:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span><span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">{</span><span class="m">001</span>,002<span class="o">}</span><span class="p">;</span><span class="k">do</span><span class="w"> </span>cat<span class="w"> </span>header.in<span class="w"> </span>supercell-<span class="nv">$i</span>.in<span class="w"> </span>&gt;<span class="p">|</span><span class="w"> </span>NaCl-<span class="nv">$i</span>.in<span class="p">;</span><span class="w"> </span><span class="k">done</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">header.in</span></code> is specially made for this NaCl example and
this file is found in <code class="docutils literal notranslate"><span class="pre">example/NaCl-QE</span></code> directory. This
setting is of course dependent on systems and has to be written for
each interested system. Note that supercells with displacements
must not be relaxed in the force calculations, because atomic
forces induced by a small atomic displacement are what we need for
phonon calculation.</p>
<p>Then QE-PW supercell calculations are executed to obtain force on
atoms, e.g., as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>mpirun<span class="w"> </span>pw.x<span class="w"> </span>-i<span class="w"> </span>NaCl-001.in<span class="w"> </span><span class="p">|&amp;</span><span class="w"> </span>tee<span class="w"> </span>NaCl-001.out
%<span class="w"> </span>mpirun<span class="w"> </span>pw.x<span class="w"> </span>-i<span class="w"> </span>NaCl-002.in<span class="w"> </span><span class="p">|&amp;</span><span class="w"> </span>tee<span class="w"> </span>NaCl-002.out
</pre></div>
</div>
</li>
<li><p>To create <code class="docutils literal notranslate"><span class="pre">FORCE_SETS</span></code>, that is used by phonopy,
the following phonopy command is executed:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>phonopy<span class="w"> </span>-f<span class="w"> </span>NaCl-001.out<span class="w"> </span>NaCl-002.out
</pre></div>
</div>
<p>Here <code class="docutils literal notranslate"><span class="pre">.out</span></code> files are the saved text files of standard outputs of the
QE-PW calculations. If more supercells with displacements were
created in the step 1, all <code class="docutils literal notranslate"><span class="pre">.out</span></code> files are given in the above
command. To run this command, <code class="docutils literal notranslate"><span class="pre">phonopy_disp.yaml</span></code> has to be located in
the current directory because the information on atomic
displacements stored in <code class="docutils literal notranslate"><span class="pre">phonopy_disp.yaml</span></code> are used to generate
<code class="docutils literal notranslate"><span class="pre">FORCE_SETS</span></code>. See some more detail at
<a class="reference internal" href="command-options.html#qe-force-sets-option"><span class="std std-ref">Quantum ESPRESSO interface</span></a>.</p>
</li>
<li><p>Now post-process of phonopy is ready to run. The unit cell file
used in the step 1 has to be specified but <code class="docutils literal notranslate"><span class="pre">FORCE_SETS</span></code> is
automatically read. Examples of post-process are shown below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">phonopy</span> <span class="o">--</span><span class="n">qe</span> <span class="o">-</span><span class="n">c</span> <span class="n">NaCl</span><span class="o">.</span><span class="ow">in</span> <span class="o">-</span><span class="n">p</span> <span class="n">band</span><span class="o">.</span><span class="n">conf</span>
        <span class="n">_</span>
  <span class="n">_</span> <span class="n">__</span> <span class="o">|</span> <span class="o">|</span><span class="n">__</span>   <span class="n">___</span>  <span class="n">_</span> <span class="n">__</span>   <span class="n">___</span>   <span class="n">_</span> <span class="n">__</span>  <span class="n">_</span>   <span class="n">_</span>
 <span class="o">|</span> <span class="s1">&#39;_ \| &#39;</span><span class="n">_</span> \ <span class="o">/</span> <span class="n">_</span> \<span class="o">|</span> <span class="s1">&#39;_ \ / _ \ | &#39;</span><span class="n">_</span> \<span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span>
 <span class="o">|</span> <span class="o">|</span><span class="n">_</span><span class="p">)</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="o">||</span> <span class="o">|</span><span class="n">_</span><span class="p">)</span> <span class="o">|</span> <span class="o">|</span><span class="n">_</span><span class="o">|</span> <span class="o">|</span>
 <span class="o">|</span> <span class="o">.</span><span class="n">__</span><span class="o">/|</span><span class="n">_</span><span class="o">|</span> <span class="o">|</span><span class="n">_</span><span class="o">|</span>\<span class="n">___</span><span class="o">/|</span><span class="n">_</span><span class="o">|</span> <span class="o">|</span><span class="n">_</span><span class="o">|</span>\<span class="n">___</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="o">.</span><span class="n">__</span><span class="o">/</span> \<span class="n">__</span><span class="p">,</span> <span class="o">|</span>
 <span class="o">|</span><span class="n">_</span><span class="o">|</span>                            <span class="o">|</span><span class="n">_</span><span class="o">|</span>    <span class="o">|</span><span class="n">___</span><span class="o">/</span>
                                      <span class="mf">1.13.0</span>

<span class="n">Python</span> <span class="n">version</span> <span class="mf">2.7.14</span>
<span class="n">Spglib</span> <span class="n">version</span> <span class="mf">1.10.3</span>
<span class="n">Calculator</span> <span class="n">interface</span><span class="p">:</span> <span class="n">qe</span>
<span class="n">Band</span> <span class="n">structure</span> <span class="n">mode</span>
<span class="n">Settings</span><span class="p">:</span>
  <span class="n">Supercell</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span><span class="p">]</span>
  <span class="n">Primitive</span> <span class="n">axis</span><span class="p">:</span>
    <span class="p">[</span> <span class="mf">0.</span>   <span class="mf">0.5</span>  <span class="mf">0.5</span><span class="p">]</span>
    <span class="p">[</span> <span class="mf">0.5</span>  <span class="mf">0.</span>   <span class="mf">0.5</span><span class="p">]</span>
    <span class="p">[</span> <span class="mf">0.5</span>  <span class="mf">0.5</span>  <span class="mf">0.</span> <span class="p">]</span>
<span class="n">Spacegroup</span><span class="p">:</span> <span class="n">Fm</span><span class="o">-</span><span class="mi">3</span><span class="n">m</span> <span class="p">(</span><span class="mi">225</span><span class="p">)</span>
<span class="n">Computing</span> <span class="n">force</span> <span class="n">constants</span><span class="o">...</span>
<span class="nb">max</span> <span class="n">drift</span> <span class="n">of</span> <span class="n">force</span> <span class="n">constants</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.001194</span> <span class="p">(</span><span class="n">zz</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.000000</span> <span class="p">(</span><span class="n">zz</span><span class="p">)</span>
<span class="n">Reciprocal</span> <span class="n">space</span> <span class="n">paths</span> <span class="ow">in</span> <span class="n">reduced</span> <span class="n">coordinates</span><span class="p">:</span>
<span class="p">[</span> <span class="mf">0.00</span>  <span class="mf">0.00</span>  <span class="mf">0.00</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span> <span class="mf">0.50</span>  <span class="mf">0.00</span>  <span class="mf">0.00</span><span class="p">]</span>
<span class="p">[</span> <span class="mf">0.50</span>  <span class="mf">0.00</span>  <span class="mf">0.00</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span> <span class="mf">0.50</span>  <span class="mf">0.50</span>  <span class="mf">0.00</span><span class="p">]</span>
<span class="p">[</span> <span class="mf">0.50</span>  <span class="mf">0.50</span>  <span class="mf">0.00</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.00</span> <span class="o">-</span><span class="mf">0.00</span>  <span class="mf">0.00</span><span class="p">]</span>
<span class="p">[</span> <span class="mf">0.00</span>  <span class="mf">0.00</span>  <span class="mf">0.00</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span> <span class="mf">0.50</span>  <span class="mf">0.50</span>  <span class="mf">0.50</span><span class="p">]</span>
<span class="o">...</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/NaCl-pwscf-band.png"><img alt="_images/NaCl-pwscf-band.png" src="_images/NaCl-pwscf-band.png" style="width: 50%;" />
</a>
<p><code class="docutils literal notranslate"><span class="pre">--qe</span> <span class="pre">-c</span> <span class="pre">NaCl.in</span></code> is specific for the QE-phonopy
calculation but the other settings are totally common among calculator
interfaces such as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">phonopy</span> <span class="o">--</span><span class="n">qe</span> <span class="o">-</span><span class="n">c</span> <span class="n">NaCl</span><span class="o">.</span><span class="ow">in</span> <span class="o">--</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2 2 2&quot;</span> <span class="p">[</span><span class="n">other</span><span class="o">-</span><span class="n">OPTIONS</span><span class="p">]</span> <span class="p">[</span><span class="n">setting</span><span class="o">-</span><span class="n">file</span><span class="p">]</span>
</pre></div>
</div>
<p>For settings and command options, see
<a class="reference internal" href="setting-tags.html#setting-tags"><span class="std std-ref">Setting tags</span></a> and <a class="reference internal" href="command-options.html#command-options"><span class="std std-ref">Command options</span></a>, respectively, and
for examples, see <a class="reference internal" href="examples.html#examples-link"><span class="std std-ref">Examples</span></a>.</p>
</li>
</ol>
<section id="non-analytical-term-correction-optional">
<h3>Non-analytical term correction (Optional)<a class="headerlink" href="#non-analytical-term-correction-optional" title="Link to this heading">#</a></h3>
<p>To activate non-analytical term correction, <a class="reference internal" href="input-files.html#born-file"><span class="std std-ref">BORN (optional)</span></a> is
required. This file contains the information of Born effective charge
and dielectric constant. These physical values are also obtained from
the PW (<code class="docutils literal notranslate"><span class="pre">pw.x</span></code>) &amp; PH (<code class="docutils literal notranslate"><span class="pre">ph.x</span></code>) codes in Quantum ESPRESSO
package. There are two steps. The first step is usual self-consistent
field (SCF) calculation
by and the second step is running its response function calculations
under DFPT.</p>
<p>For the SCF calculation, the input file <code class="docutils literal notranslate"><span class="pre">NaCl.in</span></code> looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="o">&amp;</span><span class="n">control</span>
    <span class="n">calculation</span> <span class="o">=</span> <span class="s1">&#39;scf&#39;</span>
    <span class="n">tprnfor</span> <span class="o">=</span> <span class="o">.</span><span class="n">true</span><span class="o">.</span>
    <span class="n">tstress</span> <span class="o">=</span> <span class="o">.</span><span class="n">true</span><span class="o">.</span>
    <span class="n">pseudo_dir</span> <span class="o">=</span> <span class="s1">&#39;/home/togo/espresso/pseudo/&#39;</span>
 <span class="o">/</span>
 <span class="o">&amp;</span><span class="n">system</span>
    <span class="n">ibrav</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">nat</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">ntyp</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">ecutwfc</span> <span class="o">=</span> <span class="mf">70.0</span>
 <span class="o">/</span>
 <span class="o">&amp;</span><span class="n">electrons</span>
    <span class="n">diagonalization</span> <span class="o">=</span> <span class="s1">&#39;david&#39;</span>
    <span class="n">conv_thr</span> <span class="o">=</span> <span class="mf">1.0</span><span class="n">d</span><span class="o">-</span><span class="mi">9</span>
 <span class="o">/</span>
<span class="n">ATOMIC_SPECIES</span>
 <span class="n">Na</span>  <span class="mf">22.98976928</span> <span class="n">Na</span><span class="o">.</span><span class="n">pbe</span><span class="o">-</span><span class="n">spn</span><span class="o">-</span><span class="n">kjpaw_psl</span><span class="mf">.0.2</span><span class="o">.</span><span class="n">UPF</span>
 <span class="n">Cl</span>  <span class="mf">35.453</span>      <span class="n">Cl</span><span class="o">.</span><span class="n">pbe</span><span class="o">-</span><span class="n">n</span><span class="o">-</span><span class="n">kjpaw_psl</span><span class="mf">.0.1</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">ATOMIC_POSITIONS</span> <span class="n">crystal</span>
 <span class="n">Na</span>   <span class="mf">0.0000000000000000</span>  <span class="mf">0.0000000000000000</span>  <span class="mf">0.0000000000000000</span>
 <span class="n">Na</span>   <span class="mf">0.0000000000000000</span>  <span class="mf">0.5000000000000000</span>  <span class="mf">0.5000000000000000</span>
 <span class="n">Na</span>   <span class="mf">0.5000000000000000</span>  <span class="mf">0.0000000000000000</span>  <span class="mf">0.5000000000000000</span>
 <span class="n">Na</span>   <span class="mf">0.5000000000000000</span>  <span class="mf">0.5000000000000000</span>  <span class="mf">0.0000000000000000</span>
 <span class="n">Cl</span>   <span class="mf">0.5000000000000000</span>  <span class="mf">0.5000000000000000</span>  <span class="mf">0.5000000000000000</span>
 <span class="n">Cl</span>   <span class="mf">0.5000000000000000</span>  <span class="mf">0.0000000000000000</span>  <span class="mf">0.0000000000000000</span>
 <span class="n">Cl</span>   <span class="mf">0.0000000000000000</span>  <span class="mf">0.5000000000000000</span>  <span class="mf">0.0000000000000000</span>
 <span class="n">Cl</span>   <span class="mf">0.0000000000000000</span>  <span class="mf">0.0000000000000000</span>  <span class="mf">0.5000000000000000</span>
<span class="n">CELL_PARAMETERS</span> <span class="n">angstrom</span>
 <span class="mf">5.6903014761756712</span> <span class="mi">0</span> <span class="mi">0</span>
 <span class="mi">0</span> <span class="mf">5.6903014761756712</span> <span class="mi">0</span>
 <span class="mi">0</span> <span class="mi">0</span> <span class="mf">5.6903014761756712</span>
<span class="n">K_POINTS</span> <span class="n">automatic</span>
 <span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
</pre></div>
</div>
<p>where more the k-point mesh numbers are specified. This may be exectued as:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>mpirun<span class="w"> </span>~/espresso/bin/pw.x<span class="w"> </span>-i<span class="w"> </span>NaCl.in<span class="w"> </span><span class="p">|&amp;</span><span class="w"> </span>tee<span class="w"> </span>NaCl.out
</pre></div>
</div>
<p>Many files whose names stating with <code class="docutils literal notranslate"><span class="pre">pwscf</span></code> should be created. These
are used for the next calculation. The input file for the response
function calculations, <code class="docutils literal notranslate"><span class="pre">NaCl.ph.in</span></code>, is
created as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="o">&amp;</span><span class="n">inputph</span>
  <span class="n">tr2_ph</span> <span class="o">=</span> <span class="mf">1.0</span><span class="n">d</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span>
  <span class="n">epsil</span> <span class="o">=</span> <span class="o">.</span><span class="n">true</span><span class="o">.</span>
 <span class="o">/</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
</pre></div>
</div>
<p>Similary <code class="docutils literal notranslate"><span class="pre">ph.x</span></code> is executed:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>mpirun<span class="w"> </span>~/espresso/bin/ph.x<span class="w"> </span>-i<span class="w"> </span>NaCl.ph.in<span class="w"> </span><span class="p">|&amp;</span><span class="w"> </span>tee<span class="w"> </span>NaCl.ph.out
</pre></div>
</div>
<p>Finally the Born effective charges and dielectric constant are obtained in the
output file <code class="docutils literal notranslate"><span class="pre">NaCl.ph.out</span></code>. The <code class="docutils literal notranslate"><span class="pre">BORN</span></code> file has to be created following the
<code class="docutils literal notranslate"><span class="pre">BORN</span></code> format (<a class="reference internal" href="input-files.html#born-file"><span class="std std-ref">BORN (optional)</span></a>). The <code class="docutils literal notranslate"><span class="pre">BORN</span></code> file for this NaCl calculation
would be something like below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">default</span> <span class="n">value</span>
<span class="mf">2.472958201</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mf">2.472958201</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mf">2.472958201</span>
<span class="mf">1.105385</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mf">1.105385</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mf">1.105385</span>
<span class="o">-</span><span class="mf">1.105385</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="o">-</span><span class="mf">1.105385</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="o">-</span><span class="mf">1.105385</span>
</pre></div>
</div>
<p>This <code class="docutils literal notranslate"><span class="pre">BORN</span></code> file can be made using <code class="docutils literal notranslate"><span class="pre">phonopy-qe-born</span></code> command.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>phonopy-qe-born<span class="w"> </span>NaCl.in<span class="w">  </span><span class="p">|</span><span class="w"> </span>tee<span class="w"> </span>BORN
</pre></div>
</div>
<p>Once this is made, the non-analytical term correction is included
just adding the <code class="docutils literal notranslate"><span class="pre">--nac</span></code> option as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>phonopy<span class="w"> </span>--qe<span class="w"> </span>--nac<span class="w"> </span>-c<span class="w"> </span>NaCl.in<span class="w"> </span>-p<span class="w"> </span>band.conf
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/NaCl-pwscf-band-NAC.png"><img alt="_images/NaCl-pwscf-band-NAC.png" src="_images/NaCl-pwscf-band-NAC.png" style="width: 50%;" />
</a>
</section>
</section>
<section id="using-q2r-x-to-create-phonopy-force-constants-file">
<span id="qe-q2r"></span><h2>Using <code class="docutils literal notranslate"><span class="pre">q2r.x</span></code> to create phonopy force constants file<a class="headerlink" href="#using-q2r-x-to-create-phonopy-force-constants-file" title="Link to this heading">#</a></h2>
<p><strong>Experimental</strong></p>
<p>A parser of <code class="docutils literal notranslate"><span class="pre">q2r.x</span></code> output is implemented experimentally. Currently
command-line user interface is not prepared. Using the following
script, the force constants file readable by phonopy is
created. Probably thus obtained force constants are required to be
symmetrized by the translational invariance condition using
<code class="docutils literal notranslate"><span class="pre">FC_SYMMETRY</span> <span class="pre">=</span> <span class="pre">.TRUE.</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">phonopy.interface.qe</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_pwscf</span><span class="p">,</span> <span class="n">PH_Q2R</span>

<span class="n">primcell_filename</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">q2r_filename</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">cell</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">read_pwscf</span><span class="p">(</span><span class="n">primcell_filename</span><span class="p">)</span>
<span class="n">q2r</span> <span class="o">=</span> <span class="n">PH_Q2R</span><span class="p">(</span><span class="n">q2r_filename</span><span class="p">)</span>
<span class="n">q2r</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
<span class="n">q2r</span><span class="o">.</span><span class="n">write_force_constants</span><span class="p">()</span>
</pre></div>
</div>
<p>Saving this script as <code class="docutils literal notranslate"><span class="pre">make_fc_q2r.py</span></code>, this is used as, e.g.,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>python<span class="w"> </span>make_fc_q2r.py<span class="w"> </span>NaCl.in<span class="w"> </span>NaCl.fc
</pre></div>
</div>
<p>This gives <code class="docutils literal notranslate"><span class="pre">force_constants.hdf5</span></code> file in the compact format (see
<a class="reference internal" href="input-files.html#file-force-constants"><span class="std std-ref">FORCE_CONSTANTS and force_constants.hdf5</span></a>).  From version 1.13.2, full supercell
force constants can be written by <code class="docutils literal notranslate"><span class="pre">q2r.run(cell,</span> <span class="pre">is_full_fc=True)</span></code>
instead of <code class="docutils literal notranslate"><span class="pre">q2r.run(cell)</span></code> in the above
script. <code class="docutils literal notranslate"><span class="pre">FORCE_CONSTANTS</span></code> file instead of <code class="docutils literal notranslate"><span class="pre">force_constants.hdf5</span></code>
can be obtained by <code class="docutils literal notranslate"><span class="pre">q2r.write_force_constants(fc_format='text')</span></code>.</p>
<section id="non-analytical-term-correction">
<h3>Non-analytical term correction<a class="headerlink" href="#non-analytical-term-correction" title="Link to this heading">#</a></h3>
<p>Treatment of non-analytical term correction (NAC) is different between
phonopy and QE. For insulator, QE automatically calculate dielectric
constant and Born effective charges at PH calculation when q-point
mesh sampling mode (<code class="docutils literal notranslate"><span class="pre">ldisp</span> <span class="pre">=</span> <span class="pre">.true.</span></code>), and these data are written in
the Gamma point dynamical matrix file (probably in <code class="docutils literal notranslate"><span class="pre">.dyn1</span></code>
file). When running <code class="docutils literal notranslate"><span class="pre">q2r.x</span></code>, these files are read including the
dielectric constant and Born effective charges, and the real space
force constants where QE-NAC treatment is done are written to the q2r
output file. This is not that phonopy expects. Therefore the
dielectric constant and Born effective charges data have to be removed
manually from the Gamma point dynamical matrix file before running
<code class="docutils literal notranslate"><span class="pre">q2r.x</span></code>. Alternatively Gamma point only PH calculation with ‚Äòepsil =
.false.‚Äô can generate the dynamical matrix file without the dielectric
constant and Born effective charges data. So it is possible to replace
the Gamma point file by this Gamma point only file to run <code class="docutils literal notranslate"><span class="pre">q2r.x</span></code>
for phonopy.</p>
<section id="creating-born-file">
<h4>Creating BORN file<a class="headerlink" href="#creating-born-file" title="Link to this heading">#</a></h4>
<p>If the <code class="docutils literal notranslate"><span class="pre">q2r.x</span></code> output contains dielectric constant and Born
effective charges, the following script can generate <code class="docutils literal notranslate"><span class="pre">BORN</span></code> format
text.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">phonopy.structure.symmetry</span><span class="w"> </span><span class="kn">import</span> <span class="n">elaborate_borns_and_epsilon</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">phonopy.interface.qe</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_pwscf</span><span class="p">,</span> <span class="n">PH_Q2R</span>

<span class="n">primcell_filename</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">q2r_filename</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">cell</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">read_pwscf</span><span class="p">(</span><span class="n">primcell_filename</span><span class="p">)</span>
<span class="n">q2r</span> <span class="o">=</span> <span class="n">PH_Q2R</span><span class="p">(</span><span class="n">q2r_filename</span><span class="p">)</span>
<span class="n">q2r</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">parse_fc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">if</span> <span class="n">q2r</span><span class="o">.</span><span class="n">epsilon</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">borns</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">elaborate_borns_and_epsilon</span><span class="p">(</span>
        <span class="n">cell</span><span class="p">,</span>
        <span class="n">q2r</span><span class="o">.</span><span class="n">borns</span><span class="p">,</span>
        <span class="n">q2r</span><span class="o">.</span><span class="n">epsilon</span><span class="p">,</span>
        <span class="n">supercell_matrix</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">q2r</span><span class="o">.</span><span class="n">dimension</span><span class="p">),</span>
        <span class="n">symmetrize_tensors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">((</span><span class="s2">&quot;</span><span class="si">%13.8f</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">9</span><span class="p">)</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">epsilon</span><span class="o">.</span><span class="n">ravel</span><span class="p">()))</span>
    <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">borns</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">((</span><span class="s2">&quot;</span><span class="si">%13.8f</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">9</span><span class="p">)</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">ravel</span><span class="p">()))</span>
</pre></div>
</div>
<p>Saving this script as <code class="docutils literal notranslate"><span class="pre">make_born_q2r.py</span></code>,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>python<span class="w"> </span>make_born_q2r.py<span class="w"> </span>NaCl.in<span class="w"> </span>NaCl.fc<span class="w"> </span>&gt;<span class="w"> </span>BORN
</pre></div>
</div>
</section>
<section id="nacl-example">
<h4>NaCl example<a class="headerlink" href="#nacl-example" title="Link to this heading">#</a></h4>
<p>NaCl example is found at
<a class="github reference external" href="https://github.com/phonopy/phonopy/tree/master/example/NaCl-QE-q2r">phonopy/phonopy</a>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>phonopy<span class="w"> </span>--qe<span class="w"> </span>-c<span class="w"> </span>NaCl.in<span class="w"> </span>--dim<span class="o">=</span><span class="s2">&quot;8 8 8&quot;</span><span class="w"> </span>--band<span class="o">=</span><span class="s2">&quot;0 0 0  1/2 0 0  1/2 1/2 0  0 0 0  1/2 1/2 1/2&quot;</span><span class="w"> </span>--readfc<span class="w"> </span>--readfc-format<span class="o">=</span>hdf5<span class="w"> </span>--fc-symmetry<span class="w"> </span>--nac<span class="w"> </span>-p
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/NaCl-q2r-band-NAC.png"><img alt="_images/NaCl-q2r-band-NAC.png" src="_images/NaCl-q2r-band-NAC.png" style="width: 50%;" />
</a>
</section>
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="wien2k.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Wien2k &amp; phonopy calculation</p>
      </div>
    </a>
    <a class="right-next"
       href="abinit.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Abinit &amp; phonopy calculation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#supported-qe-pw-tags">Supported QE-PW tags</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-run">How to run</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#non-analytical-term-correction-optional">Non-analytical term correction (Optional)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-q2r-x-to-create-phonopy-force-constants-file">Using <code class="docutils literal notranslate"><span class="pre">q2r.x</span></code> to create phonopy force constants file</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#non-analytical-term-correction">Non-analytical term correction</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-born-file">Creating BORN file</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nacl-example">NaCl example</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Author name not set
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2009, Atsushi Togo.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>