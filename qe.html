
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Quantum ESPRESSO (QE) &amp; phonopy calculation &#8212; Phonopy v.2.17.1</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Abinit &amp; phonopy calculation" href="abinit.html" />
    <link rel="prev" title="Wien2k &amp; phonopy calculation" href="wien2k.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Phonopy v.2.17.1</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="install.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="symmetry.html">
   Crystal symmetry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="workflow.html">
   Work flow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="examples.html">
   Examples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="input-files.html">
   Input files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="output-files.html">
   Output files
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="setting-tags.html">
   Setting tags
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="animation.html">
     How to watch animation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="command-options.html">
   Command options
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dynamic-structure-factor.html">
   Dynamic structure factor
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="gruneisen.html">
   Mode Grüneisen parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="qha.html">
   Quasi harmonic approximation
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="interfaces.html">
   Interfaces to calculators
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="vasp.html">
     VASP &amp; phonopy calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="wien2k.html">
     Wien2k &amp; phonopy calculation
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Quantum ESPRESSO (QE) &amp; phonopy calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="abinit.html">
     Abinit &amp; phonopy calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="siesta.html">
     Siesta &amp; phonopy calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="elk.html">
     Elk &amp; phonopy calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="crystal.html">
     CRYSTAL &amp; phonopy calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dftb%2B.html">
     DFTB+ &amp; phonopy calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="turbomole.html">
     TURBOMOLE &amp; phonopy calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cp2k.html">
     CP2K &amp; phonopy calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="aims.html">
     FHI-aims &amp; phonopy calculations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="castep.html">
     CASTEP &amp; phonopy calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Fleur.html">
     Fleur &amp; phonopy calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vasp-dfpt.html">
     VASP-DFPT &amp; phonopy calculation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="auxiliary-tools.html">
   Auxiliary tools
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="external-tools.html">
   External tools
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="phonopy-module.html">
   Phonopy API for Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="phonopy-load.html">
   phonopy-load command
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="formulation.html">
   Formulations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="citation.html">
   How to cite phonopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reference.html">
   References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="changelog.html">
   Change Log
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/qe.rst.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#supported-qe-pw-tags">
   Supported QE-PW tags
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-to-run">
   How to run
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#non-analytical-term-correction-optional">
     Non-analytical term correction (Optional)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-q2r-x-to-create-phonopy-force-constants-file">
   Using
   <code class="docutils literal notranslate">
    <span class="pre">
     q2r.x
    </span>
   </code>
   to create phonopy force constants file
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#non-analytical-term-correction">
     Non-analytical term correction
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#creating-born-file">
       Creating BORN file
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#nacl-example">
       NaCl example
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Quantum ESPRESSO (QE) & phonopy calculation</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#supported-qe-pw-tags">
   Supported QE-PW tags
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-to-run">
   How to run
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#non-analytical-term-correction-optional">
     Non-analytical term correction (Optional)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-q2r-x-to-create-phonopy-force-constants-file">
   Using
   <code class="docutils literal notranslate">
    <span class="pre">
     q2r.x
    </span>
   </code>
   to create phonopy force constants file
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#non-analytical-term-correction">
     Non-analytical term correction
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#creating-born-file">
       Creating BORN file
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#nacl-example">
       NaCl example
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="quantum-espresso-qe-phonopy-calculation">
<span id="qe-interface"></span><h1>Quantum ESPRESSO (QE) &amp; phonopy calculation<a class="headerlink" href="#quantum-espresso-qe-phonopy-calculation" title="Permalink to this headline">#</a></h1>
<p>Quantum ESPRESSO package itself has a set of the phonon calculation
system. But the document here explains how to calculate phonons using
phonopy, i.e., using the finite displacement and supercell approach.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#supported-qe-pw-tags" id="id1">Supported QE-PW tags</a></p></li>
<li><p><a class="reference internal" href="#how-to-run" id="id2">How to run</a></p>
<ul>
<li><p><a class="reference internal" href="#non-analytical-term-correction-optional" id="id3">Non-analytical term correction (Optional)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#using-q2r-x-to-create-phonopy-force-constants-file" id="id4">Using <code class="docutils literal notranslate"><span class="pre">q2r.x</span></code> to create phonopy force constants file</a></p>
<ul>
<li><p><a class="reference internal" href="#non-analytical-term-correction" id="id5">Non-analytical term correction</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="supported-qe-pw-tags">
<h2><a class="toc-backref" href="#id1">Supported QE-PW tags</a><a class="headerlink" href="#supported-qe-pw-tags" title="Permalink to this headline">#</a></h2>
<p>Currently QE-PW tags that phonopy can read are shown below.  Only
<code class="docutils literal notranslate"><span class="pre">ibrav</span> <span class="pre">=</span> <span class="pre">0</span></code> type representation of crystal structure is supported.
More tags may be supported on request.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nat</span><span class="p">,</span> <span class="n">ntyp</span><span class="p">,</span> <span class="n">celldm</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">ATOMIC_SPECIES</span><span class="p">,</span> <span class="n">ATOMIC_POSITIONS</span><span class="p">,</span> <span class="n">CELL_PARAMETERS</span>
</pre></div>
</div>
</section>
<section id="how-to-run">
<h2><a class="toc-backref" href="#id2">How to run</a><a class="headerlink" href="#how-to-run" title="Permalink to this headline">#</a></h2>
<p>The procedure of QE-phonopy calculation is shown below using the
NaCl example found in <code class="docutils literal notranslate"><span class="pre">example/NaCl-QE</span></code> directory.</p>
<ol class="arabic">
<li><p>Read a QE-PW input file and create supercells with
<a class="reference internal" href="command-options.html#qe-mode"><span class="std std-ref">--qe</span></a> option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">phonopy</span> <span class="o">--</span><span class="n">qe</span> <span class="o">-</span><span class="n">d</span> <span class="o">--</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2 2 2&quot;</span> <span class="o">-</span><span class="n">c</span> <span class="n">NaCl</span><span class="o">.</span><span class="ow">in</span>
</pre></div>
</div>
<p>In this example, 2x2x2 supercells are created. <code class="docutils literal notranslate"><span class="pre">supercell.in</span></code> and
<code class="docutils literal notranslate"><span class="pre">supercell-xxx.in</span></code> (<code class="docutils literal notranslate"><span class="pre">xxx</span></code> are numbers) give the perfect
supercell and supercells with displacements, respectively. In the
case of the NaCl example, two files <code class="docutils literal notranslate"><span class="pre">supercell-001.in</span></code> and
<code class="docutils literal notranslate"><span class="pre">supercell-002.in</span></code> are created. In these supercell files, lines
only relevant to crystal structures are
given. <code class="docutils literal notranslate"><span class="pre">phonopy_disp.yaml</span></code> is also generated, which contains
information about supercell and displacements.</p>
</li>
<li><p>To make QE-PW input files, necessary setting information is added to
<code class="docutils literal notranslate"><span class="pre">supercell-xxx.in</span></code> files, e.g., by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>% for i in {001,002};do cat header.in supercell-$i.in &gt;| NaCl-$i.in; done
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">header.in</span></code> is specially made for this NaCl example and
this file is found in <code class="docutils literal notranslate"><span class="pre">example/NaCl-QE</span></code> directory. This
setting is of course dependent on systems and has to be written for
each interested system. Note that supercells with displacements
must not be relaxed in the force calculations, because atomic
forces induced by a small atomic displacement are what we need for
phonon calculation.</p>
<p>Then QE-PW supercell calculations are executed to obtain force on
atoms, e.g., as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">mpirun</span> <span class="n">pw</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span><span class="n">i</span> <span class="n">NaCl</span><span class="o">-</span><span class="mf">001.</span><span class="ow">in</span> <span class="o">|&amp;</span> <span class="n">tee</span> <span class="n">NaCl</span><span class="o">-</span><span class="mf">001.</span><span class="n">out</span>
<span class="o">%</span> <span class="n">mpirun</span> <span class="n">pw</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span><span class="n">i</span> <span class="n">NaCl</span><span class="o">-</span><span class="mf">002.</span><span class="ow">in</span> <span class="o">|&amp;</span> <span class="n">tee</span> <span class="n">NaCl</span><span class="o">-</span><span class="mf">002.</span><span class="n">out</span>
</pre></div>
</div>
</li>
<li><p>To create <code class="docutils literal notranslate"><span class="pre">FORCE_SETS</span></code>, that is used by phonopy,
the following phonopy command is executed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">phonopy</span> <span class="o">-</span><span class="n">f</span> <span class="n">NaCl</span><span class="o">-</span><span class="mf">001.</span><span class="n">out</span> <span class="n">NaCl</span><span class="o">-</span><span class="mf">002.</span><span class="n">out</span>
</pre></div>
</div>
<p>Here <code class="docutils literal notranslate"><span class="pre">.out</span></code> files are the saved text files of standard outputs of the
QE-PW calculations. If more supercells with displacements were
created in the step 1, all <code class="docutils literal notranslate"><span class="pre">.out</span></code> files are given in the above
command. To run this command, <code class="docutils literal notranslate"><span class="pre">phonopy_disp.yaml</span></code> has to be located in
the current directory because the information on atomic
displacements stored in <code class="docutils literal notranslate"><span class="pre">phonopy_disp.yaml</span></code> are used to generate
<code class="docutils literal notranslate"><span class="pre">FORCE_SETS</span></code>. See some more detail at
<a class="reference internal" href="command-options.html#qe-force-sets-option"><span class="std std-ref">Quantum ESPRESSO interface</span></a>.</p>
</li>
<li><p>Now post-process of phonopy is ready to run. The unit cell file
used in the step 1 has to be specified but <code class="docutils literal notranslate"><span class="pre">FORCE_SETS</span></code> is
automatically read. Examples of post-process are shown below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">phonopy</span> <span class="o">--</span><span class="n">qe</span> <span class="o">-</span><span class="n">c</span> <span class="n">NaCl</span><span class="o">.</span><span class="ow">in</span> <span class="o">-</span><span class="n">p</span> <span class="n">band</span><span class="o">.</span><span class="n">conf</span>
        <span class="n">_</span>
  <span class="n">_</span> <span class="n">__</span> <span class="o">|</span> <span class="o">|</span><span class="n">__</span>   <span class="n">___</span>  <span class="n">_</span> <span class="n">__</span>   <span class="n">___</span>   <span class="n">_</span> <span class="n">__</span>  <span class="n">_</span>   <span class="n">_</span>
 <span class="o">|</span> <span class="s1">&#39;_ \| &#39;</span><span class="n">_</span> \ <span class="o">/</span> <span class="n">_</span> \<span class="o">|</span> <span class="s1">&#39;_ \ / _ \ | &#39;</span><span class="n">_</span> \<span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span>
 <span class="o">|</span> <span class="o">|</span><span class="n">_</span><span class="p">)</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="o">||</span> <span class="o">|</span><span class="n">_</span><span class="p">)</span> <span class="o">|</span> <span class="o">|</span><span class="n">_</span><span class="o">|</span> <span class="o">|</span>
 <span class="o">|</span> <span class="o">.</span><span class="n">__</span><span class="o">/|</span><span class="n">_</span><span class="o">|</span> <span class="o">|</span><span class="n">_</span><span class="o">|</span>\<span class="n">___</span><span class="o">/|</span><span class="n">_</span><span class="o">|</span> <span class="o">|</span><span class="n">_</span><span class="o">|</span>\<span class="n">___</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="o">.</span><span class="n">__</span><span class="o">/</span> \<span class="n">__</span><span class="p">,</span> <span class="o">|</span>
 <span class="o">|</span><span class="n">_</span><span class="o">|</span>                            <span class="o">|</span><span class="n">_</span><span class="o">|</span>    <span class="o">|</span><span class="n">___</span><span class="o">/</span>
                                      <span class="mf">1.13.0</span>

<span class="n">Python</span> <span class="n">version</span> <span class="mf">2.7.14</span>
<span class="n">Spglib</span> <span class="n">version</span> <span class="mf">1.10.3</span>
<span class="n">Calculator</span> <span class="n">interface</span><span class="p">:</span> <span class="n">qe</span>
<span class="n">Band</span> <span class="n">structure</span> <span class="n">mode</span>
<span class="n">Settings</span><span class="p">:</span>
  <span class="n">Supercell</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span><span class="p">]</span>
  <span class="n">Primitive</span> <span class="n">axis</span><span class="p">:</span>
    <span class="p">[</span> <span class="mf">0.</span>   <span class="mf">0.5</span>  <span class="mf">0.5</span><span class="p">]</span>
    <span class="p">[</span> <span class="mf">0.5</span>  <span class="mf">0.</span>   <span class="mf">0.5</span><span class="p">]</span>
    <span class="p">[</span> <span class="mf">0.5</span>  <span class="mf">0.5</span>  <span class="mf">0.</span> <span class="p">]</span>
<span class="n">Spacegroup</span><span class="p">:</span> <span class="n">Fm</span><span class="o">-</span><span class="mi">3</span><span class="n">m</span> <span class="p">(</span><span class="mi">225</span><span class="p">)</span>
<span class="n">Computing</span> <span class="n">force</span> <span class="n">constants</span><span class="o">...</span>
<span class="nb">max</span> <span class="n">drift</span> <span class="n">of</span> <span class="n">force</span> <span class="n">constants</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.001194</span> <span class="p">(</span><span class="n">zz</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.000000</span> <span class="p">(</span><span class="n">zz</span><span class="p">)</span>
<span class="n">Reciprocal</span> <span class="n">space</span> <span class="n">paths</span> <span class="ow">in</span> <span class="n">reduced</span> <span class="n">coordinates</span><span class="p">:</span>
<span class="p">[</span> <span class="mf">0.00</span>  <span class="mf">0.00</span>  <span class="mf">0.00</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span> <span class="mf">0.50</span>  <span class="mf">0.00</span>  <span class="mf">0.00</span><span class="p">]</span>
<span class="p">[</span> <span class="mf">0.50</span>  <span class="mf">0.00</span>  <span class="mf">0.00</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span> <span class="mf">0.50</span>  <span class="mf">0.50</span>  <span class="mf">0.00</span><span class="p">]</span>
<span class="p">[</span> <span class="mf">0.50</span>  <span class="mf">0.50</span>  <span class="mf">0.00</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.00</span> <span class="o">-</span><span class="mf">0.00</span>  <span class="mf">0.00</span><span class="p">]</span>
<span class="p">[</span> <span class="mf">0.00</span>  <span class="mf">0.00</span>  <span class="mf">0.00</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="p">[</span> <span class="mf">0.50</span>  <span class="mf">0.50</span>  <span class="mf">0.50</span><span class="p">]</span>
<span class="o">...</span>
</pre></div>
</div>
<p><a class="reference internal" href="_images/NaCl-pwscf-band.png"><img alt="pwscf-band" src="_images/NaCl-pwscf-band.png" style="width: 50%;" /></a></p>
<p><code class="docutils literal notranslate"><span class="pre">--qe</span> <span class="pre">-c</span> <span class="pre">NaCl.in</span></code> is specific for the QE-phonopy
calculation but the other settings are totally common among calculator
interfaces such as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">phonopy</span> <span class="o">--</span><span class="n">qe</span> <span class="o">-</span><span class="n">c</span> <span class="n">NaCl</span><span class="o">.</span><span class="ow">in</span> <span class="o">--</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2 2 2&quot;</span> <span class="p">[</span><span class="n">other</span><span class="o">-</span><span class="n">OPTIONS</span><span class="p">]</span> <span class="p">[</span><span class="n">setting</span><span class="o">-</span><span class="n">file</span><span class="p">]</span>
</pre></div>
</div>
<p>For settings and command options, see
<a class="reference internal" href="setting-tags.html#setting-tags"><span class="std std-ref">Setting tags</span></a> and <a class="reference internal" href="command-options.html#command-options"><span class="std std-ref">Command options</span></a>, respectively, and
for examples, see <a class="reference internal" href="examples.html#examples-link"><span class="std std-ref">Examples</span></a>.</p>
</li>
</ol>
<section id="non-analytical-term-correction-optional">
<h3><a class="toc-backref" href="#id3">Non-analytical term correction (Optional)</a><a class="headerlink" href="#non-analytical-term-correction-optional" title="Permalink to this headline">#</a></h3>
<p>To activate non-analytical term correction, <a class="reference internal" href="input-files.html#born-file"><span class="std std-ref">BORN (optional)</span></a> is
required. This file contains the information of Born effective charge
and dielectric constant. These physical values are also obtained from
the PW (<code class="docutils literal notranslate"><span class="pre">pw.x</span></code>) &amp; PH (<code class="docutils literal notranslate"><span class="pre">ph.x</span></code>) codes in Quantum ESPRESSO
package. There are two steps. The first step is usual self-consistent
field (SCF) calculation
by and the second step is running its response function calculations
under DFPT.</p>
<p>For the SCF calculation, the input file <code class="docutils literal notranslate"><span class="pre">NaCl.in</span></code> looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="o">&amp;</span><span class="n">control</span>
    <span class="n">calculation</span> <span class="o">=</span> <span class="s1">&#39;scf&#39;</span>
    <span class="n">tprnfor</span> <span class="o">=</span> <span class="o">.</span><span class="n">true</span><span class="o">.</span>
    <span class="n">tstress</span> <span class="o">=</span> <span class="o">.</span><span class="n">true</span><span class="o">.</span>
    <span class="n">pseudo_dir</span> <span class="o">=</span> <span class="s1">&#39;/home/togo/espresso/pseudo/&#39;</span>
 <span class="o">/</span>
 <span class="o">&amp;</span><span class="n">system</span>
    <span class="n">ibrav</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">nat</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">ntyp</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">ecutwfc</span> <span class="o">=</span> <span class="mf">70.0</span>
 <span class="o">/</span>
 <span class="o">&amp;</span><span class="n">electrons</span>
    <span class="n">diagonalization</span> <span class="o">=</span> <span class="s1">&#39;david&#39;</span>
    <span class="n">conv_thr</span> <span class="o">=</span> <span class="mf">1.0</span><span class="n">d</span><span class="o">-</span><span class="mi">9</span>
 <span class="o">/</span>
<span class="n">ATOMIC_SPECIES</span>
 <span class="n">Na</span>  <span class="mf">22.98976928</span> <span class="n">Na</span><span class="o">.</span><span class="n">pbe</span><span class="o">-</span><span class="n">spn</span><span class="o">-</span><span class="n">kjpaw_psl</span><span class="mf">.0.2</span><span class="o">.</span><span class="n">UPF</span>
 <span class="n">Cl</span>  <span class="mf">35.453</span>      <span class="n">Cl</span><span class="o">.</span><span class="n">pbe</span><span class="o">-</span><span class="n">n</span><span class="o">-</span><span class="n">kjpaw_psl</span><span class="mf">.0.1</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">ATOMIC_POSITIONS</span> <span class="n">crystal</span>
 <span class="n">Na</span>   <span class="mf">0.0000000000000000</span>  <span class="mf">0.0000000000000000</span>  <span class="mf">0.0000000000000000</span>
 <span class="n">Na</span>   <span class="mf">0.0000000000000000</span>  <span class="mf">0.5000000000000000</span>  <span class="mf">0.5000000000000000</span>
 <span class="n">Na</span>   <span class="mf">0.5000000000000000</span>  <span class="mf">0.0000000000000000</span>  <span class="mf">0.5000000000000000</span>
 <span class="n">Na</span>   <span class="mf">0.5000000000000000</span>  <span class="mf">0.5000000000000000</span>  <span class="mf">0.0000000000000000</span>
 <span class="n">Cl</span>   <span class="mf">0.5000000000000000</span>  <span class="mf">0.5000000000000000</span>  <span class="mf">0.5000000000000000</span>
 <span class="n">Cl</span>   <span class="mf">0.5000000000000000</span>  <span class="mf">0.0000000000000000</span>  <span class="mf">0.0000000000000000</span>
 <span class="n">Cl</span>   <span class="mf">0.0000000000000000</span>  <span class="mf">0.5000000000000000</span>  <span class="mf">0.0000000000000000</span>
 <span class="n">Cl</span>   <span class="mf">0.0000000000000000</span>  <span class="mf">0.0000000000000000</span>  <span class="mf">0.5000000000000000</span>
<span class="n">CELL_PARAMETERS</span> <span class="n">angstrom</span>
 <span class="mf">5.6903014761756712</span> <span class="mi">0</span> <span class="mi">0</span>
 <span class="mi">0</span> <span class="mf">5.6903014761756712</span> <span class="mi">0</span>
 <span class="mi">0</span> <span class="mi">0</span> <span class="mf">5.6903014761756712</span>
<span class="n">K_POINTS</span> <span class="n">automatic</span>
 <span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
</pre></div>
</div>
<p>where more the k-point mesh numbers are specified. This may be exectued as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mpirun</span> <span class="o">~/</span><span class="n">espresso</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">pw</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span><span class="n">i</span> <span class="n">NaCl</span><span class="o">.</span><span class="ow">in</span> <span class="o">|&amp;</span> <span class="n">tee</span> <span class="n">NaCl</span><span class="o">.</span><span class="n">out</span>
</pre></div>
</div>
<p>Many files whose names stating with <code class="docutils literal notranslate"><span class="pre">pwscf</span></code> should be created. These
are used for the next calculation. The input file for the response
function calculations, <code class="docutils literal notranslate"><span class="pre">NaCl.ph.in</span></code>, is
created as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="o">&amp;</span><span class="n">inputph</span>
  <span class="n">tr2_ph</span> <span class="o">=</span> <span class="mf">1.0</span><span class="n">d</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span>
  <span class="n">epsil</span> <span class="o">=</span> <span class="o">.</span><span class="n">true</span><span class="o">.</span>
 <span class="o">/</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
</pre></div>
</div>
<p>Similary <code class="docutils literal notranslate"><span class="pre">ph.x</span></code> is executed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">mpirun</span> <span class="o">~/</span><span class="n">espresso</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">ph</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span><span class="n">i</span> <span class="n">NaCl</span><span class="o">.</span><span class="n">ph</span><span class="o">.</span><span class="ow">in</span> <span class="o">|&amp;</span> <span class="n">tee</span> <span class="n">NaCl</span><span class="o">.</span><span class="n">ph</span><span class="o">.</span><span class="n">out</span>
</pre></div>
</div>
<p>Finally the Born effective charges and dielectric constant are
obtained in the output file <code class="docutils literal notranslate"><span class="pre">NaCl.ph.out</span></code>. The <code class="docutils literal notranslate"><span class="pre">BORN</span></code> file has to
be created manually following the <code class="docutils literal notranslate"><span class="pre">BORN</span></code> format
(<a class="reference internal" href="input-files.html#born-file"><span class="std std-ref">BORN (optional)</span></a>). The <code class="docutils literal notranslate"><span class="pre">BORN</span></code> file for this NaCl calculation would
be something like below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">default</span> <span class="n">value</span>
<span class="mf">2.472958201</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mf">2.472958201</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mf">2.472958201</span>
<span class="mf">1.105385</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mf">1.105385</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mf">1.105385</span>
<span class="o">-</span><span class="mf">1.105385</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="o">-</span><span class="mf">1.105385</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="o">-</span><span class="mf">1.105385</span>
</pre></div>
</div>
<p>Once this is made, the non-analytical term correction is included
just adding the <code class="docutils literal notranslate"><span class="pre">--nac</span></code> option as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">phonopy</span> <span class="o">--</span><span class="n">qe</span> <span class="o">--</span><span class="n">nac</span> <span class="o">-</span><span class="n">c</span> <span class="n">NaCl</span><span class="o">.</span><span class="ow">in</span> <span class="o">-</span><span class="n">p</span> <span class="n">band</span><span class="o">.</span><span class="n">conf</span>
</pre></div>
</div>
<p><a class="reference internal" href="_images/NaCl-pwscf-band-NAC.png"><img alt="pwscf-band-nac" src="_images/NaCl-pwscf-band-NAC.png" style="width: 50%;" /></a></p>
</section>
</section>
<section id="using-q2r-x-to-create-phonopy-force-constants-file">
<span id="qe-q2r"></span><h2><a class="toc-backref" href="#id4">Using <code class="docutils literal notranslate"><span class="pre">q2r.x</span></code> to create phonopy force constants file</a><a class="headerlink" href="#using-q2r-x-to-create-phonopy-force-constants-file" title="Permalink to this headline">#</a></h2>
<p><strong>Experimental</strong></p>
<p>A parser of <code class="docutils literal notranslate"><span class="pre">q2r.x</span></code> output is implemented experimentally. Currently
command-line user interface is not prepared. Using the following
script, the force constants file readable by phonopy is
created. Probably thus obtained force constants are required to be
symmetrized by the translational invariance condition using
<code class="docutils literal notranslate"><span class="pre">FC_SYMMETRY</span> <span class="pre">=</span> <span class="pre">.TRUE.</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">phonopy.interface.qe</span> <span class="kn">import</span> <span class="n">read_pwscf</span><span class="p">,</span> <span class="n">PH_Q2R</span>

<span class="n">primcell_filename</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">q2r_filename</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">cell</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">read_pwscf</span><span class="p">(</span><span class="n">primcell_filename</span><span class="p">)</span>
<span class="n">q2r</span> <span class="o">=</span> <span class="n">PH_Q2R</span><span class="p">(</span><span class="n">q2r_filename</span><span class="p">)</span>
<span class="n">q2r</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
<span class="n">q2r</span><span class="o">.</span><span class="n">write_force_constants</span><span class="p">()</span>
</pre></div>
</div>
<p>Saving this script as <code class="docutils literal notranslate"><span class="pre">make_fc_q2r.py</span></code>, this is used as, e.g.,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">python</span> <span class="n">make_fc_q2r</span><span class="o">.</span><span class="n">py</span> <span class="n">NaCl</span><span class="o">.</span><span class="ow">in</span> <span class="n">NaCl</span><span class="o">.</span><span class="n">fc</span>
</pre></div>
</div>
<p>This gives <code class="docutils literal notranslate"><span class="pre">force_constants.hdf5</span></code> file in the compact format (see
<a class="reference internal" href="input-files.html#file-force-constants"><span class="std std-ref">FORCE_CONSTANTS and force_constants.hdf5</span></a>).  From version 1.13.2, full supercell
force constants can be written by <code class="docutils literal notranslate"><span class="pre">q2r.run(cell,</span> <span class="pre">is_full_fc=True)</span></code>
instead of <code class="docutils literal notranslate"><span class="pre">q2r.run(cell)</span></code> in the above
script. <code class="docutils literal notranslate"><span class="pre">FORCE_CONSTANTS</span></code> file instead of <code class="docutils literal notranslate"><span class="pre">force_constants.hdf5</span></code>
can be obtained by <code class="docutils literal notranslate"><span class="pre">q2r.write_force_constants(fc_format='text')</span></code>.</p>
<section id="non-analytical-term-correction">
<h3><a class="toc-backref" href="#id5">Non-analytical term correction</a><a class="headerlink" href="#non-analytical-term-correction" title="Permalink to this headline">#</a></h3>
<p>Treatment of non-analytical term correction (NAC) is different between
phonopy and QE. For insulator, QE automatically calculate dielectric
constant and Born effective charges at PH calculation when q-point
mesh sampling mode (<code class="docutils literal notranslate"><span class="pre">ldisp</span> <span class="pre">=</span> <span class="pre">.true.</span></code>), and these data are written in
the Gamma point dynamical matrix file (probably in <code class="docutils literal notranslate"><span class="pre">.dyn1</span></code>
file). When running <code class="docutils literal notranslate"><span class="pre">q2r.x</span></code>, these files are read including the
dielectric constant and Born effective charges, and the real space
force constants where QE-NAC treatment is done are written to the q2r
output file. This is not that phonopy expects. Therefore the
dielectric constant and Born effective charges data have to be removed
manually from the Gamma point dynamical matrix file before running
<code class="docutils literal notranslate"><span class="pre">q2r.x</span></code>. Alternatively Gamma point only PH calculation with ‘epsil =
.false.’ can generate the dynamical matrix file without the dielectric
constant and Born effective charges data. So it is possible to replace
the Gamma point file by this Gamma point only file to run <code class="docutils literal notranslate"><span class="pre">q2r.x</span></code>
for phonopy.</p>
<section id="creating-born-file">
<h4>Creating BORN file<a class="headerlink" href="#creating-born-file" title="Permalink to this headline">#</a></h4>
<p>If the <code class="docutils literal notranslate"><span class="pre">q2r.x</span></code> output contains dielectric constant and Born
effective charges, the following script can generate <code class="docutils literal notranslate"><span class="pre">BORN</span></code> format
text.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">phonopy.structure.symmetry</span> <span class="kn">import</span> <span class="n">elaborate_borns_and_epsilon</span>
<span class="kn">from</span> <span class="nn">phonopy.interface.qe</span> <span class="kn">import</span> <span class="n">read_pwscf</span><span class="p">,</span> <span class="n">PH_Q2R</span>

<span class="n">primcell_filename</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">q2r_filename</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">cell</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">read_pwscf</span><span class="p">(</span><span class="n">primcell_filename</span><span class="p">)</span>
<span class="n">q2r</span> <span class="o">=</span> <span class="n">PH_Q2R</span><span class="p">(</span><span class="n">q2r_filename</span><span class="p">)</span>
<span class="n">q2r</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">parse_fc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">if</span> <span class="n">q2r</span><span class="o">.</span><span class="n">epsilon</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">borns</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">elaborate_borns_and_epsilon</span><span class="p">(</span>
        <span class="n">cell</span><span class="p">,</span>
        <span class="n">q2r</span><span class="o">.</span><span class="n">borns</span><span class="p">,</span>
        <span class="n">q2r</span><span class="o">.</span><span class="n">epsilon</span><span class="p">,</span>
        <span class="n">supercell_matrix</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">q2r</span><span class="o">.</span><span class="n">dimension</span><span class="p">),</span>
        <span class="n">symmetrize_tensors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">((</span><span class="s2">&quot;</span><span class="si">%13.8f</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">9</span><span class="p">)</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">epsilon</span><span class="o">.</span><span class="n">ravel</span><span class="p">()))</span>
    <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">borns</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">((</span><span class="s2">&quot;</span><span class="si">%13.8f</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">9</span><span class="p">)</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">ravel</span><span class="p">()))</span>
</pre></div>
</div>
<p>Saving this script as <code class="docutils literal notranslate"><span class="pre">make_born_q2r.py</span></code>,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">python</span> <span class="n">make_born_q2r</span><span class="o">.</span><span class="n">py</span> <span class="n">NaCl</span><span class="o">.</span><span class="ow">in</span> <span class="n">NaCl</span><span class="o">.</span><span class="n">fc</span> <span class="o">&gt;</span> <span class="n">BORN</span>
</pre></div>
</div>
</section>
<section id="nacl-example">
<h4>NaCl example<a class="headerlink" href="#nacl-example" title="Permalink to this headline">#</a></h4>
<p>NaCl example is found at
<a class="reference external" href="https://github.com/phonopy/phonopy/tree/master/example/NaCl-QE-q2r">https://github.com/phonopy/phonopy/tree/master/example/NaCl-QE-q2r</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">phonopy</span> <span class="o">--</span><span class="n">qe</span> <span class="o">-</span><span class="n">c</span> <span class="n">NaCl</span><span class="o">.</span><span class="ow">in</span> <span class="o">--</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;8 8 8&quot;</span> <span class="o">--</span><span class="n">band</span><span class="o">=</span><span class="s2">&quot;0 0 0  1/2 0 0  1/2 1/2 0  0 0 0  1/2 1/2 1/2&quot;</span> <span class="o">--</span><span class="n">readfc</span> <span class="o">--</span><span class="n">readfc</span><span class="o">-</span><span class="nb">format</span><span class="o">=</span><span class="n">hdf5</span> <span class="o">--</span><span class="n">fc</span><span class="o">-</span><span class="n">symmetry</span> <span class="o">--</span><span class="n">nac</span> <span class="o">-</span><span class="n">p</span>
</pre></div>
</div>
<p><a class="reference internal" href="_images/NaCl-q2r-band-NAC.png"><img alt="q2r-band-nac" src="_images/NaCl-q2r-band-NAC.png" style="width: 50%;" /></a></p>
</section>
</section>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="wien2k.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Wien2k &amp; phonopy calculation</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="abinit.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Abinit &amp; phonopy calculation</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
      &copy; Copyright 2009, Atsushi Togo.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>